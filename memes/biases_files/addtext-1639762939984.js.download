!function(e){function t(t){for(var i,s,a=t[0],l=t[1],c=t[2],h=0,m=[];h<a.length;h++)s=a[h],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&m.push(o[s][0]),o[s]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);for(d&&d(t);m.length;)m.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,a=1;a<n.length;a++){var l=n[a];0!==o[l]&&(i=!1)}i&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},o={2:0},r=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/watermarkly/";var a=window.webpackJsonp=window.webpackJsonp||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var d=l;r.push([222,1,0]),n()}({17:function(e,t,n){"use strict";n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return y})),n.d(t,"f",(function(){return w})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return v}));var i=n(0),o=n(29),r=n(4),s=n(5),a=n(1),l=n(3),c=n(13),d=n(42),h=function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s};const m=n(53),p=n(54),u=n(55);let g=class extends i.Component{constructor(e){super(e),this.onBeginUpdate=this.onBeginUpdate.bind(this),this.updateModel()}get formattedValue(){return(this.props.proxy.scale/this.props.imageScale).toFixed(1)+"x"}itemToSliderScale(e){const t=e*this.baseItemSize/this.baseScale;let n=Object(a.nb)(Math.pow(t-this.minItemSize,this.log),0,100);return Number.isNaN(n)&&(n=0),n}sliderToItemScale(e){const t=Math.pow(e,1/this.log)+this.minItemSize;let n=this.baseScale*t/this.baseItemSize;return Number.isNaN(n)&&(n=1),n}onScaleChange(e){const t=this.props,n=t.proxy,i=t.constraints,o=i?i.anchorX:r.a.begin,s=i?i.anchorY:r.a.begin;if(e=this.sliderToItemScale(e),n.scale!==e){const t=e*this.oldBounds.width/this.baseScale,i=e*this.oldBounds.height/this.baseScale;let l,c;switch(o){case r.a.begin:l=this.oldBounds.x;break;case r.a.middle:l=this.oldBounds.centerX-t/2;break;case r.a.end:l=this.oldBounds.x+this.oldBounds.width-t}switch(s){case r.a.begin:c=this.oldBounds.y;break;case r.a.middle:c=this.oldBounds.centerY-i/2;break;case r.a.end:c=this.oldBounds.y+this.oldBounds.height-i}n.scale=e,n.bounds=new a.g(l,c,t,i)}}updateModel(){const e=this.props,t=e.proxy;this.oldBounds=t.bounds;const n=e.imageSize;let i=1.5*n.width;this.oldBounds.height*i/this.oldBounds.width>1.5*n.height?(i=1.5*n.height,this.baseItemSize=this.oldBounds.height):this.baseItemSize=this.oldBounds.width,this.minItemSize=Math.min(5*Math.max(this.oldBounds.width,this.oldBounds.height)/Math.min(this.oldBounds.width,this.oldBounds.height),this.baseItemSize),i=Math.max(i,this.baseItemSize),this.minItemSize==i&&(this.minItemSize=0),this.log=Math.log(100)/Math.log(i-this.minItemSize),this.baseScale=t.scale}onBeginUpdate(){this.props.onStartScaleChanging&&this.props.onStartScaleChanging(),this.updateModel()}render(){const e=this.props.proxy;return i.createElement(o.a,{value:this.itemToSliderScale(e.scale),formattedValue:this.formattedValue,onChange:this.onScaleChange,onBeginUpdate:this.onBeginUpdate,onEndUpdate:this.props.onEndScaleChanging,disableRailClicks:!0})}};h([l.c.bound],g.prototype,"onScaleChange",null),g=h([s.a],g);let f=class extends i.Component{render(){let e=this.props.proxy.opacity;return i.createElement(o.a,{value:100/.99*(e-.01),formattedValue:Math.round(100*e)+"%",onChange:this.onChange})}onChange(e){this.props.proxy.opacity=Math.round(100*Math.min(1,.01+e/(100/.99)))/100}};h([l.c.bound],f.prototype,"onChange",null),f=h([s.a],f);const b=[45,90,135,180,225,270,315];let y=class extends i.Component{render(){const e=this.props.proxy.item.rotation;return i.createElement(o.a,{value:e*(100/359.99),formattedValue:Math.round(e)+"Â°",onChange:this.onChange})}onChange(e){let t=Object(a.nb)(e/(100/359.99),0,360);for(let e=b.length-1;e>=0;e--)if(Math.abs(b[e]-t)<5){t=b[e];break}this.props.proxy.item.rotation=t}};function w(){return 0}h([l.c.bound],y.prototype,"onChange",null),y=h([s.a],y);let x=class extends i.Component{get initialValue(){return this.props.proxy.item.tileSpan}get minValue(){return Math.min(0,this.initialValue)}get maxValue(){return Math.max(function(e,t){const n=t.bounds.minSize;return e.min/2/n}(this.props.imageSize,this.props.proxy),this.initialValue)}render(){const e=this.minValue,t=this.maxValue,n=100*(this.initialValue-e)/(t-e);return i.createElement(o.a,{value:n,onChange:this.onChange})}onChange(e){const t=this.minValue,n=this.maxValue;this.props.proxy.item.tileSpan=t+e*(n-t)/100}};h([l.c.bound],x.prototype,"onChange",null),x=h([s.a],x);let v=class extends i.Component{constructor(e){super(e),this.onButtonClicked=Object(l.c)("set tile mode",e=>{const t=e,n=this.props.proxy,i=n.item.tile;n.item.tile=t,i==r.i.none&&t!==r.i.none&&(n.item.tileSpan=function(e,t){const n=t.bounds.minSize;return e.min/4/n}(this.props.imageSize,n))})}render(){let e=this.props.proxy.item.tile;return i.createElement(d.a,{selectedIndex:e,buttons:[{children:i.createElement(c.a,{src:m})},{children:i.createElement(c.a,{src:p})},{children:i.createElement(c.a,{src:u})}],onClick:this.onButtonClicked})}};v=h([s.a],v)},222:function(e,t,n){e.exports=n(236)},223:function(e,t,n){var i=n(224);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(21)(i,o);i.locals&&(e.exports=i.locals)},224:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".add-text-editor {\n  display: flex;\n  flex-direction: row;\n  align-content: stretch;\n  user-select: none;\n  cursor: default;\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.add-text-editor > .editor-container {\n  position: relative;\n  flex-grow: 2;\n}\n.add-text-editor > .no-images-hint {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  display: none;\n}\n.add-text-editor > .no-images-hint > .empty-text {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 50%;\n  transform: translateY(-50%);\n  text-align: center;\n  user-select: none;\n}\n.add-text-editor > .no-images-hint > .empty-text > img,\n.add-text-editor > .no-images-hint > .empty-text > .svg-image {\n  user-select: none;\n  user-drag: none;\n  user-focus: none;\n  width: 96px;\n  height: 96px;\n}\n.add-text-editor > .no-images-hint > .empty-text > .hint {\n  font-size: 20px;\n  margin: 20px;\n}\n.add-text-editor > .no-images-hint > .empty-text > .or {\n  font-size: 16px;\n  margin: 20px;\n}\n.add-text-editor.no-images > .no-images-hint {\n  display: block;\n}\n",""])},225:function(e,t,n){var i=n(226);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(21)(i,o);i.locals&&(e.exports=i.locals)},226:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".add-text-component > .loading-cover {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  display: none;\n  z-index: 1;\n  opacity: 1;\n  background: rgba(0, 0, 0, 0.01);\n}\n.add-text-component.working {\n  filter: blur(5px);\n}\n.add-text-component.working > .loading-cover {\n  display: block;\n}\n",""])},236:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n(19),r=n(1),s=n(15),a=n(14),l=n(5),c=n(7),d=n(3),h=n(37),m=n(2),p=n(8),u=n(40),g=n(13),f=function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s};n(223);const b=n(80);let y=class extends i.Component{constructor(e){super(e),this.onImagesChanged=this.onImagesChanged.bind(this),this.setEditorRef=this.setEditorRef.bind(this)}render(){const e=this.props,t=e.task,n=e.watermarkEditorModel,o=0===t.imageCount;return n.showImageNumber=!1,i.createElement("div",{className:Object(r.w)("add-text-editor",o&&"no-images")},i.createElement("div",{className:"editor-container"},i.createElement(u.a,{model:n,ref:this.setEditorRef,disableDropCover:!0})),i.createElement("div",{className:"no-images-hint"},i.createElement("div",{className:"empty-text"},i.createElement(g.a,{src:b}),!n.isTouch&&i.createElement(i.Fragment,null,i.createElement("div",{className:"hint"},Object(m.c)("drag-your-image-here")),i.createElement("div",{className:"or"},Object(m.c)("or")),i.createElement("button",{className:Object(r.w)("select-files"),onClick:e.onSelectPhotosClicked},Object(m.c)("select-image-action"))),n.isTouch&&i.createElement("div",{className:"hint"},Object(m.c)("select-image-for-adding-text")))))}componentDidMount(){this.taskImagesObserveDisposer=Object(d.d)(this.onImagesChanged)}componentWillUnmount(){this.taskImagesObserveDisposer&&(this.taskImagesObserveDisposer(),this.taskImagesObserveDisposer=null)}onImagesChanged(){const e=this.props.task;(e.imageCount>0?e.images[0]:null)!=this.props.watermarkEditorModel.loadedPreview&&this.watermarkEditor.reconsiderPreview()}setEditorRef(e){this.watermarkEditor=e}};y=f([l.a],y);var w=n(58),x=n(36),v=n(22),E=n(9),k=n(45),C=n(25),O=n(38),S=function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},j=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};n(225);let I=class extends i.Component{constructor(e){super(e),this.dropZoneState=2,this.dropZoneVisible=!1,this.setImage=this.setImage.bind(this),this.selectImageHandler=this.selectImageHandler.bind(this),this.onDragEnter=this.onDragEnter.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.showSaveImageHint=Object(r.B)(this.showSaveImageHint.bind(this),1500),this.showAddTextHint=Object(r.B)(this.showAddTextHint.bind(this),1500);const t=this.props.task;this.watermarkEditorModel=new u.b(t),this.addWatermarkItemDisabled=Object(d.f)(()=>0===t.imageCount),this.saveImageDisabled=Object(d.f)(()=>0===t.imageCount||0===this.watermarkEditorModel.proxies.length),this.watermarker=new w.a(t);let n=this.watermarkEditorModel.selectedProxyIndex;const i=Object(d.e)(()=>{n>=0&&this.watermarkEditorModel.selectedProxyIndex<0&&(this.showSaveImageHint(),i()),n=this.watermarkEditorModel.selectedProxyIndex},100)}render(){const e=this.props.task,t=this.watermarker.working;let n=Object(r.w)("add-text-component","app-component",t&&"working",r.n);return i.createElement("div",{className:n,onDragEnter:this.onDragEnter},i.createElement(c.a,null),i.createElement(h.a,{pageIndex:0,hideBackButton:!0,pages:[{actions:[{name:Object(m.c)("add-text-action"),disabled:this.addWatermarkItemDisabled,handler:this.watermarkEditorModel.addText},{name:Object(m.c)("add-logo-action"),disabled:this.addWatermarkItemDisabled,handler:this.watermarkEditorModel.addLogo},{name:this.watermarkEditorModel.removeWatermarkActionName,handler:this.watermarkEditorModel.removeItem,disabled:this.watermarkEditorModel.removeItemDisabled,optional:!0}],children:i.createElement(y,{task:e,watermarkEditorModel:this.watermarkEditorModel,onSelectPhotosClicked:this.selectImageHandler}),nextButton:{name:Object(m.c)("save-image-action"),handler:this.saveImageHandler,disabled:this.saveImageDisabled}}],bottomBar:[i.createElement(C.a,{isIOsApp:r.T,key:"account-component"})],topLeftBar:i.createElement("button",{onClick:this.selectImageHandler},Object(m.c)("select-image-action"))}),i.createElement("div",{className:Object(r.w)("drop-cover",this.dropZoneVisible&&"visible",2==this.dropZoneState&&"hiding",1==this.dropZoneState&&"showing"),onDragOver:this.onDragOver,onDrop:this.onDrop,onDragLeave:this.onDragLeave}),t&&i.createElement(x.b,null),i.createElement(c.c,null),r.V&&i.createElement("div",{className:"mobile-rotate-your-phone"},i.createElement("div",null,Object(m.c)("please-rotate-your-device"))))}selectImageHandler(e){Object(p.g)(e.currentTarget,!0).then(this.setImage,e=>{Object(r.lb)(new Error("openFilePicker failed: "+e),!0)})}onDragEnter(e){e.preventDefault(),this.dropZoneVisible=!0,setTimeout(()=>this.dropZoneState=1,1)}onDragOver(e){e.preventDefault()}onDrop(e){e.preventDefault(),this.hideDropZone(),v.a.fromItemList(e.dataTransfer.items).then(this.setImage)}onDragLeave(e){e.preventDefault(),this.hideDropZone()}hideDropZone(){this.dropZoneState=2,setTimeout(Object(d.c)(()=>{this.dropZoneVisible=!1}),300)}setImage(e){return j(this,void 0,void 0,(function*(){if(e.length>0){const t=this.props.task;t.clearImages(),yield t.addImages(e[0]),e.length>1?this.showUpgradeToBatchMode():this.showAddTextHint()}}))}saveImageHandler(){return j(this,void 0,void 0,(function*(){this.watermarkEditorModel.setSelectedProxy(null),yield this.watermarkEditorModel.saveProxies();const e=this.watermarkEditorModel.task;if(0==e.imageCount)return;if((yield Object(k.a)(r.k.addText))>e.limits.images)return void Object(C.f)(e.limits.images);const t=e.images[0].name;try{yield this.watermarker.start(O.d.writer)}catch(t){Object(p.e)(t)&&(yield e.removeFailingImages()),Object(p.d)(t,"Failed to add text to a picture.")}try{yield this.props.task.saveSettingsToLocalStorage(),yield Object(k.c)(r.k.addText,t)}catch(e){Object(r.lb)(e,!0)}}))}showAddTextHint(){if(0==this.watermarkEditorModel.proxies.length){const e=r.V?document.querySelectorAll(".mobile-actions-container .page-action")[1]:document.querySelectorAll(".actions-container .page-action")[1];Object(c.l)(Object(m.c)("click-add-text-hint",Object(m.c)("add-text-action"),Object(m.c)("add-logo-action")),e,"add-text")}else this.watermarkEditorModel.highlightItems()}showSaveImageHint(){this.watermarkEditorModel.selectedProxyIndex<0&&this.watermarkEditorModel.proxies.length>0&&Object(c.l)(Object(m.c)("click-save-image-button-hint",Object(m.c)("save-image-action")),Object(h.b)(),"save-image")}showUpgradeToBatchMode(){"visualwatermark"===r.n?setTimeout(()=>{Object(c.e)({text:Object(m.c)("add-text-use-batch-tool","Visual Watermark"),buttons:[{label:Object(m.c)("download-visual-watermark-action"),onClick:E.f},{label:Object(m.c)("cancel")}],onClick:E.f})},500):setTimeout(()=>{Object(c.e)({onClick:r.V?E.e:E.z,text:Object(m.c)("add-text-use-batch-tool","Watermarkly"),buttons:[{label:Object(m.c)("run-app-action","watermarkly"),onClick:r.V?E.e:E.z},{label:Object(m.c)("cancel")}]})},500)}};S([d.l],I.prototype,"dropZoneState",void 0),S([d.l],I.prototype,"dropZoneVisible",void 0),S([d.c.bound],I.prototype,"saveImageHandler",null),I=S([l.a],I);var M=n(49),P=n(12),T=n(10);n.d(t,"start",(function(){return J}));var U=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};function J(e){return U(this,void 0,void 0,(function*(){if(!e)throw Error("root element not provided");if(!Object(r.Eb)())return void o.render(i.createElement(M.a,null),e);Object(a.d)(),n(70),"#test-error"===location.hash&&setTimeout(()=>{throw Error("test error")},1e3);const t=new s.c({settingsKey:"add-text-task",convertToLocalImages:!0});Object(d.d)(()=>{T.c.get()?t.limits={items:10,putNag:!1,images:r.L}:t.limits={items:10,putNag:!1,images:5}}),yield t.loadSettingsFromLocalStorage(),r.C&&(window.task=t),o.render(i.createElement(I,{task:t}),e),Object(r.E)(),Object(p.b)(e),yield Object(v.d)(t.images),yield Object(P.e)(),r.C&&!r.Hb&&"localhost:8081"!=location.host&&(yield t.addImages("/test-files/wallpaper.jpeg"))}))}window["start-add-text"]=J},27:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return w})),n.d(t,"d",(function(){return x}));var i,o=n(4),r=n(0),s=n(19),a=n(5),l=n(1),c=n(3),d=n(17),h=n(8),m=n(24),p=function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s};function u(e,t){return 0!=e&&t.width>0&&t.height>0?"rotate("+e+" "+t.centerX+" "+t.centerY+")":""}function g(e,t,n,i,s,a,c,d,h){const p=e.item,g=e.scale,b=u(p.rotation,t),y=e.bounds.width<f.MIN_TOUCH_ZONE_SIZE||e.bounds.height<f.MIN_TOUCH_ZONE_SIZE||void 0;if(p instanceof o.h){const n=function(e){return e.includes(" ")?"'"+e+"'":e}(p.fontName),c=e.renderedLines;if(1===c.length)return r.createElement("text",{ref:d,key:h,x:t.x,y:"edge"===Object(l.s)()?t.y+o.h.defaultFontSize*g:t.y,dominantBaseline:"text-before-edge",fontSize:o.h.defaultFontSize*g,fontFamily:n,filter:i,style:a,transform:b,cursor:"default",fill:s,"data-extended-click-zone":y,"data-proxy-id":e.id},c[0]||"empty watermark");{const m=p.lineHeight+"em";let u="start",f=0;switch(p.alignment){case o.c.center:u="middle",f=t.width/2;break;case o.c.right:u="end",f=t.width}return r.createElement("text",{ref:d,key:h,x:t.x+f,y:"edge"===Object(l.s)()?t.y+o.h.defaultFontSize*g:t.y,dominantBaseline:"text-before-edge",fontSize:o.h.defaultFontSize*g,fontFamily:n,filter:i,style:a,transform:b,cursor:"default",fill:s,"data-extended-click-zone":y,"data-proxy-id":e.id},c.map((e,n)=>r.createElement("tspan",{key:"text-line-"+n,textAnchor:u,x:t.x+f,dy:0==n?"":m},e||" ")))}}if(p instanceof o.d){const o=p.img;let s=n?p.selfContainedImgSrc:p.scaledImgSrc||p.imgSrc;return n&&s.startsWith("blob:")&&(Object(l.lb)(new Error("ItemComponent - blob img src for self contained component"),!0),s=p.img.toDataURL("image/png")),r.createElement("image",{ref:d,key:h,x:t.x,y:t.y,href:s,width:o.width*g,height:o.height*g,filter:i,style:a,transform:b,"data-extended-click-zone":y,"data-proxy-id":e.id})}if(p instanceof o.f)return r.createElement("rect",Object.assign({ref:d,key:h},t,{fill:s,filter:i,style:a,transform:b,"data-extended-click-zone":y,"data-proxy-id":e.id}));if(p instanceof o.b)return r.createElement("text",{ref:d,key:h,x:t.x,y:"edge"===Object(l.s)()?t.y+o.h.defaultFontSize*g:t.y,dominantBaseline:"text-before-edge",fontSize:o.h.defaultFontSize*g,fontFamily:m.b,filter:i,style:a,transform:b,cursor:"default",fill:s,"data-extended-click-zone":y,"data-proxy-id":e.id},p.char);if(p instanceof o.g){const n=p;return r.createElement("image",{ref:d,key:h,x:t.x,y:t.y,href:n.dataUrl,width:n.width*g,height:n.height*g,filter:i,style:a,transform:b,"data-extended-click-zone":y,"data-proxy-id":e.id})}throw Error("unsupported proxy type ("+p+")")}n(56);let f=class extends r.Component{constructor(e){super(e),this.setRef=this.setRef.bind(this),this.updateBounds=this.updateBounds.bind(this);const t=l.Hb?()=>this.updateBounds():Object(l.B)(this.updateBounds,100);this.updateBoundsAsync=()=>{this.dragging||this.props.selfContained||t()}}get draggingImpl(){return this.props.draggingImpl}get dragging(){return this.draggingImpl&&this.draggingImpl.dragging}render(){const e=this.props,t=e.proxy,n=e.bounds||t.bounds,i=o.o[t.item.filter],s=Object(o.n)(i,e.filterId),a=Object(o.m)(i,e.filterId,t.bounds,t),l=g(t,t.bounds,e.selfContained,s,e.fill,a,this.draggingImpl&&this.draggingImpl.events,this.setRef);return i.svg?r.createElement(r.Fragment,null,i.svg(t.item,n,e.filterId,t.opacity,t.id),l):l}componentDidMount(){this.updateBoundsAsync&&this.updateBoundsAsync()}componentDidUpdate(){this.updateBoundsAsync&&this.updateBoundsAsync()}setRef(e){this.elem=e}updateBounds(){const e=this.elem,t=this.props.proxy;if(e)if(e.transform&&e.transform.baseVal.numberOfItems>0){const n=[];for(let t=0;t<e.transform.baseVal.numberOfItems;t++)n.push(e.transform.baseVal.getItem(t));if(e.transform.baseVal.clear(),t.updateBounds(this.props.imageSize,e.getBoundingClientRect()),0==e.transform.baseVal.numberOfItems)for(let t=0;t<n.length;t++)e.transform.baseVal.appendItem(n[t])}else t.updateBounds(this.props.imageSize,e.getBoundingClientRect())}};function b(e,t){let n=b._cache;n||(n=new WeakMap,b._cache=n);let i=n.get(e);const r=Math.max(e.item.tileSpan,Object(d.f)());if(i&&i.mode===e.item.tile&&i.tileSpan===r&&i.bounds.equals(e.bounds)&&i.imageSize.equals(t))return i.repetitions;const s=i&&i.repetitions,a=e.item.tile==o.i.straight?function(e,t,n,i){const o=n*e.minSize*1.1,r=n*e.minSize,s=i||[];let a=0,c=e.x,d=e.y;for(;c>=-e.width;)c-=e.width+o;for(;d>=-e.height;)d-=e.height+r;const h=c;for(d+=e.height+r;d<t.height;){for(c=h+e.width+o;c<t.width;){if(a>=s.length)s.push(new l.c(c,d,e.width,e.height));else{const t=s[a];t.x=c,t.y=d,t.width=e.width,t.height=e.height}a++,c+=e.width+o}d+=e.height+r}for(;a<s.length;)s[a].reset(),a++;return s}(e.bounds,t,r,s):function(e,t,n,i){const o=n*e.minSize*1.1,r=n*e.minSize,s=i||[];let a=!1,c=0,d=e.x,h=e.y;for(;d>=-e.width;)d-=e.width+o;for(;h>=-e.height;)h-=e.height+r,a=!a;const m=d;for(h+=e.height+r,a=!a;h<t.height;){for(d=a?m+(e.width+o)/2:m+e.width+o;d<t.width;){if(c>=s.length)s.push(new l.c(d,h,e.width,e.height));else{const t=s[c];t.x=d,t.y=h,t.width=e.width,t.height=e.height}c++,d+=e.width+o}h+=e.height+r,a=!a}for(;c<s.length;)s[c].reset(),c++;return s}(e.bounds,t,r,s);return i={mode:e.item.tile,bounds:e.bounds,imageSize:t,tileSpan:r,repetitions:a},n.set(e,i),a}f.MIN_TOUCH_ZONE_SIZE=50,p([c.f],f.prototype,"dragging",null),f=p([a.a],f);let y=i=class extends f{constructor(e){super(e),this.renderCounter=0,this.fullRenderCounter=0,this.fullRenderRequested=!1,this.requestFullRender=Object(l.B)(()=>{this.fullRenderRequested=!0,this.fullRenderCounter++},300)}render(){this.fullRenderCounter;const{proxy:e,id:t,imageSize:n,selfContained:s}=this.props,a=e.bounds.width<f.MIN_TOUCH_ZONE_SIZE||e.bounds.height<f.MIN_TOUCH_ZONE_SIZE||void 0,c=b(e,n),d=Object.assign({},this.props),h=o.o[e.item.filter],m=Object(o.n)(h,d.filterId),p=Object(o.m)(h,d.filterId,e.bounds,e),u=this.nodeList||(this.nodeList=[]);u.length>0&&u.splice(0);let y=t+"-symbol";l.Z&&(y+=++this.renderCounter);const w=e.bounds.clone({x:0,y:0}),x=1.5*Math.max(e.bounds.width,e.bounds.height),v=(x-e.bounds.width)/2,E=(x-e.bounds.height)/2,k=w.grow(v,E);u.push(r.createElement("symbol",{key:y,id:y,width:k.width,height:k.height,viewBox:k.viewBox},h.svg&&h.svg(e.item,w,d.filterId,e.item.opacity,e.id,y+"-filter-bg"),g(e,w,d.selfContained,m,this.props.fill,p,0,this.setRef,y+"-item-component")));const C="#"+y,O=this.draggingImpl;if(c.length<i.MAX_REP_COUNT||this.fullRenderRequested||s){this.fullRenderRequested=!1;for(let n=0,i=c.length;n<i;n++){const i=c[n];i.empty||u.push(r.createElement("use",{href:C,key:t+"-rep-"+n,x:i.x-v,y:i.y-E,width:k.width,height:k.height,"data-extended-click-zone":a,"data-proxy-id":e.id}))}}else{let n,o;O&&(O.dragging||e.dragging)&&O.parentElem&&O.parentElem instanceof SVGElement?(n=O.clientX-O.parentElemBounds.left,o=O.clientY-O.parentElemBounds.top):(n=e.bounds.centerX,o=e.bounds.centerY);for(const e of c)e._distance=e.distanceTo(n,o);c.sort((e,t)=>e._distance-t._distance);for(let n=0;n<i.MAX_REP_COUNT;n++){const i=c[n];i.empty||u.push(r.createElement("use",{href:C,key:t+"-rep-"+n,x:i.x-v,y:i.y-E,width:k.width,height:k.height,"data-extended-click-zone":a,"data-proxy-id":e.id}))}this.requestFullRender()}return r.createElement(r.Fragment,null,u)}};y.MAX_REP_COUNT=50,p([c.l],y.prototype,"fullRenderCounter",void 0),y=i=p([a.a],y);let w=class extends r.Component{constructor(e){super(e)}render(){const e=this.props.owner,t=e.snappedZones;return t&&0!=t.length&&e.isDragging?r.createElement(r.Fragment,null,t.map((e,t)=>e instanceof h.a?r.createElement("line",{key:"snapped-zone-"+t,className:"snap-line",x1:Math.max(1,e.x1),y1:Math.max(1,e.y1),x2:Math.max(1,e.x2),y2:Math.max(1,e.y2)}):null)):null}};function x(e){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("width","500"),t.setAttribute("height","500"),Object.assign(t.style,{position:"absolute",left:0,top:0,width:window.innerWidth,height:window.innerHeight,opacity:0}),document.body.appendChild(t),new Promise((n,i)=>{const a=new o.j({item:e});let d=!1;const h=Object(c.d)(()=>{const e=a.bounds;e.width>0&&e.height>0&&(d=!0,h(),t.remove(),n(e.size))});s.render(r.createElement(f,{proxy:a,proxies:[a],imageSize:new l.i(window.innerWidth,window.innerHeight),filterId:"",fill:"#ffffff",id:"item1",bounds:new l.g(0,0,50,25),selfContained:!1}),t,()=>{setTimeout(()=>{d||(s.unmountComponentAtNode(t),h(),t.remove(),i(new Error("Cannot calculate size in time")))},2e3)})})}w=p([a.a],w)},40:function(e,t,n){"use strict";n(15);var i=n(4),o=n(0),r=n(5),s=n(1),a=n(3),l=n(44),c=n(17),d=n(76),h=n(8),m=n(25),p=n(24),u=n(63),g=n(10),f=n(2),b=n(36),y=n(29),w=n(42),x=n(13),v=n(43),E=n(41),k=function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},C=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};n(81);const O=n(47),S=n(99),j=n(83);let I=class extends o.Component{constructor(e){super(e),this.previews=[],this.onDeleteTemplateClicked=this.onDeleteTemplateClicked.bind(this),this.onDownloadTemplateClicked=this.onDownloadTemplateClicked.bind(this),this.updatePreviews=this.updatePreviews.bind(this),this.updatePreviews()}get visible(){return this.props.visible&&this.props.templateLoader&&this.props.templateLoader.observableCount>0}render(){const e=this.props.templateLoader.subscriptionExpired,t=Object(s.w)("inline-templates-component",this.visible&&"visible",this.props.vertical&&"vertical");return o.createElement("div",{className:t},o.createElement("h3",null,Object(f.c)("watermark-templates")),o.createElement("div",{className:"templates-container"},this.previews.map((t,n)=>o.createElement("div",{className:"img",key:"preview-"+n},o.createElement("img",{src:t.img,onClick:t.clickHandler}),o.createElement(x.a,{src:S,className:"download-button","data-index":n,title:Object(f.c)("download-template-action"),onClick:this.onDownloadTemplateClicked}),o.createElement(x.a,{src:O,className:"delete-button","data-index":n,title:Object(f.c)("delete-template-action"),onClick:this.onDeleteTemplateClicked}),t.synced.get()&&!e&&o.createElement(x.a,{src:j,className:"sync-state",title:Object(f.c)("template-was-synced")})))),e&&o.createElement("div",{className:"expired-warning"},o.createElement("span",null,Object(f.c)("subscription-expired")),o.createElement("button",{onClick:v.d},Object(f.c)("find-out-more"))))}componentDidMount(){this.subscribeToChanges()}componentWillUnmount(){this.unsubscribeFromChanges()}subscribeToChanges(){this.unobserve=this.props.templateLoader&&Object(a.m)(this.props.templateLoader,"changeCounter",this.updatePreviews)}unsubscribeFromChanges(){this.unobserve&&this.unobserve()}onDeleteTemplateClicked(e){const t=parseInt(e.currentTarget.dataset.index),n=this.previews[t];Object(s.vb)(n.img),this.previews.splice(t,1),this.props.templateLoader.remove(t)}onDownloadTemplateClicked(e){return C(this,void 0,void 0,(function*(){const t=parseInt(e.currentTarget.dataset.index),n=yield Object(v.b)(this.props.templateLoader,t);return Object(E.b)(n,"template-"+(t+1)+".watermarkly",!0)}))}updatePreviews(){return C(this,void 0,void 0,(function*(){const e=this.props.templateLoader;if(e){const t=yield e.previews();this.setPreviews(t)}else this.setPreviews([])}))}setPreviews(e){for(let e=this.previews.length-1;e>=0;e--)Object(s.vb)(this.previews[e].img);this.previews.splice(0,this.previews.length);for(let t=0;t<e.length;t++)this.previews.push({img:URL.createObjectURL(e[t].blob),clickHandler:this.props.onPreviewClicked?()=>{this.props.onPreviewClicked(t)}:null,synced:e[t].synced})}};k([a.l.shallow],I.prototype,"previews",void 0),k([a.f],I.prototype,"visible",null),k([a.c],I.prototype,"setPreviews",null),I=k([r.a],I);let M=class extends I{render(){return o.createElement("div",{className:Object(s.w)("templates-component",this.visible&&"visible")},super.render())}};M=k([r.a],M);var P=n(32),T=n.n(P),U=n(59),J=n(27),z=n(6),L=n(61),R=n(22),B=(n(19),n(50)),N=n(62),D=n(7);n.d(t,"b",(function(){return A})),n.d(t,"c",(function(){return _})),n.d(t,"a",(function(){return W}));var V=function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},Z=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};n(84);const H=n(86),F=n(87),Q=n(88);class A{constructor(e,t){this.onlyScaleEditor=!1,this.onlyOpacityEditor=!1,this.showImageNumber=!0,this.allowSelection=!0,this.isTouch=s.bb,this.isMobile=s.V,this.snappedZones=[],this._watchChanges=!1,this.loadSettings=this.loadSettings.bind(this),this.saveProxies=this.saveProxies.bind(this),this.saveSettings=this.saveSettings.bind(this),this.reconsiderPreview=this.reconsiderPreview.bind(this),this.getProxyDraggingImpl=this.getProxyDraggingImpl.bind(this),this.task=e,this._selectedProxyIndex=-1,this.proxies=[],this.containerSize=new s.i,this.imageSize=new s.i,this.naturalImageSize=new s.i,this._loadingCounter=0,this.watermarkHighlights=[],this.pendingHighlightItems=!1,this._imageIndex=0,this.saveSettingsFrequency=void 0===t?2e3:t,this.removeItemDisabled=Object(a.f)(()=>0==this.proxies.length)}get imageScale(){return!this.naturalImageSize||this.naturalImageSize.empty||!this.imageSize||this.imageSize.empty?1:this.imageSize.width/this.naturalImageSize.width}get isLoading(){return this._loadingCounter>0}get selectedProxyIndex(){return this._selectedProxyIndex}set selectedProxyIndex(e){this.allowSelection?this._selectedProxyIndex=e:this._selectedProxyIndex=-1}get selectedProxy(){return this.proxies[this.selectedProxyIndex]||null}correctedTiledProxyBounds(e,t,n){const i=this.imageSize,o=Object(J.f)(e,i);if(o.length>0){let i=o[0],r=i.distanceTo(t,n);for(let e=1,s=o.length;e<s;e++){const s=o[e],a=s.distanceTo(t,n);a<r&&(i=s,r=a)}e.bounds=i.toRect()}}setSelectedProxy(e,t,n){const o=this.selectedProxy,r=this.imageSize;if(o!=e){if(o)if(o.item.tile===i.i.none){const e=new s.g(0,0,r.width,r.height);o.bounds.intersect(e)||(o.bounds=o.bounds.bringTo(e))}else this.correctedTiledProxyBounds(o,r.width/2,r.height/2);if(e){if(e.item.tile!=i.i.none){const i=t>=0&&t<r.width?t:r.width/2,o=n>=0&&n<r.height?n:r.height/2;this.correctedTiledProxyBounds(e,i,o)}this.selectedProxyIndex=this.proxies.indexOf(e)}else this.selectedProxyIndex=-1}}get isDragging(){for(let e=this.proxies.length-1;e>=0;e--)if(this.proxies[e].dragging)return!0;return!1}get imageIndex(){return this._imageIndex}setImageIndex(e){return Z(this,void 0,void 0,(function*(){return e=Object(s.nb)(e,0,this.task.imageCount-1),this._imageIndex!=e?(yield this.saveSettings(),this._imageIndex=e,this.proxies=[],this.imageSize=new s.i,this.naturalImageSize=new s.i,this.reconsiderPreview(this.containerSize)):Promise.resolve()}))}saveSettings(){return Z(this,void 0,void 0,(function*(){if(!this.isDragging)return this.saveProxies()}))}beginLoading(){this._loadingCounter++}endLoading(){if(this._loadingCounter--,this._loadingCounter<0)throw new Error("Unpaired endLoading call")}reconsiderPreview(e){return Z(this,void 0,void 0,(function*(){const t=e.width,n=e.height,i=this.task,o=this.imageIndex>=0&&this.imageIndex<i.imageCount?i.images[this.imageIndex]:null;if(yield this.saveProxies(),o&&t>0&&n>0&&(this.loadedPreview!=o||!this.containerSize.equals(e)))if(e.width>this.containerSize.width||e.height>this.containerSize.height||this.loadedPreview!=o){const r=this.containerSize,l=this.loadedPreview;Object(a.n)(()=>{this.containerSize=e.clone(),this.loadedPreview=o,this.snappedZones=[],this.beginLoading()});try{const o=yield 0===this.imageIndex?i.firstImagePreview(t,n):i.imagePreview(this.imageIndex,t,n);this.imagePreview&&Object(s.vb)(this.imagePreview);let r=yield i.getNaturalImageSize(this.imageIndex);const l=o.size.fit(e.width,e.height);Math.abs(r.width/r.height-l.width/l.height)>.01&&(Object(s.lb)(new Error("Got invalid image size from probe."),!0),r=yield this.task.getNaturalImageSize(this.imageIndex,!1)),Object(a.n)(()=>{this.imagePreview=window.URL.createObjectURL(o.blob),this.imageSize=l,this.naturalImageSize=r}),yield this.getProxiesFromTask()}catch(e){if(Object(a.n)(()=>{this.containerSize=r,this.loadedPreview=l}),this.ioErrorHandler||(this.ioErrorHandler=Object(h.c)()),!this.ioErrorHandler(e,o.name))throw e}finally{this.endLoading()}}else Object(a.n)(()=>{this.imageSize=this.imageSize.fit(e.width,e.height),this.containerSize=e.clone()}),yield this.getProxiesFromTask();this.pendingHighlightItems&&(this.pendingHighlightItems=!1,yield Object(s.A)(1500),this.highlightItems())}))}getProxiesFromTask(){return Z(this,void 0,void 0,(function*(){if(this.imageSize.empty||this.naturalImageSize.empty)this.proxies=[];else{const e=this.task.toProxies(this.naturalImageSize,0==this.imageIndex||this.task.autoSize,this.imageIndex),t=this.imageScale;for(const n of e)n.bounds=n.bounds.scale(t),n.scale=n.scale*t;this.proxies=e}}))}saveProxies(){return Z(this,void 0,void 0,(function*(){if(!this.imageSize.empty&&!this.naturalImageSize.empty){const e=1/this.imageScale,t=this.proxies.map(t=>t.clone({bounds:t.bounds.scale(e),scale:t.scale*e}));this.task.fromProxies(this.naturalImageSize,t,0==this.imageIndex||this.task.autoSize,this.imageIndex)}}))}removeProxy(e){this.selectedProxy==e&&this.setSelectedProxy(null);const t=this.proxies.slice();t.splice(t.indexOf(e),1),this.proxies=t}removeAllProxies(){this.setSelectedProxy(null),this.proxies=[]}addProxy(e){const t=this.proxies.slice();t.push(e),this.proxies=t,this.setSelectedProxy(e)}removeItem(){this.selectedProxyIndex<0?this.removeAllProxies():this.removeProxy(this.selectedProxy)}get removeWatermarkActionName(){if(this.selectedProxyIndex<0)return Object(f.c)("remove-watermark-action");{const e=this.selectedProxy;return e&&e.item instanceof i.h?Object(f.c)("remove-text-action"):e&&e.item instanceof i.d||i.b?Object(f.c)("remove-logo-action"):Object(f.c)("remove-watermark-action")}}addText(){return new Promise(e=>{if(this.proxies.length>=this.task.limits.items)return Object(m.g)(this.task),void e();const t=new i.j({bounds:new s.g((this.imageSize.width-60)/2,(this.imageSize.height-30)/2,60,30),item:new i.h({filter:"shadow-2"})});let n=Object(a.m)(t,"bounds",Object(a.c)("center text item",()=>{n(),n=null;const i=.1*this.imageSize.min/Math.min(t.bounds.width,t.bounds.height);t.bounds=new s.g((this.imageSize.width-t.bounds.width*i)/2,(this.imageSize.height-t.bounds.height*i)/2,t.bounds.width*i,t.bounds.height*i),t.scale=i,this.selectedProxy==t&&e()}));this.addProxy(t),null==n&&e()})}addLogoCore(e,t,n){let o=1,r=Math.min(this.imageSize.width,this.imageSize.height)/3;const a=Math.max(t,n);a>r?(o=r/a,t*=o,n*=o):a<r/5&&(o=r/5/a,t*=o,n*=o);const l=new i.j({bounds:new s.g((this.imageSize.width-t)/2,(this.imageSize.height-n)/2,t,n),scale:o,item:e});this.addProxy(l)}addLogo(e){return Z(this,void 0,void 0,(function*(){if(this.proxies.length>=this.task.limits.items)Object(m.g)(this.task);else try{const t=yield Object(h.g)(e.currentTarget,!1,!0);if(t&&t.length>=1){let e,n,o;const r=t[0];yield Object(D.m)(()=>Z(this,void 0,void 0,(function*(){if(Object(L.a)(r)){e=new i.b({char:r,filter:"shadow-2"});const t=yield Object(J.d)(e);n=t.width,o=t.height}else if(Object(L.b)(r)){const t=r.startsWith("<svg")?r:yield Object(s.kb)(r);e=new i.g({svg:t,filter:"shadow-2"});const a=yield Object(J.d)(e);n=a.width,o=a.height}else{let r=yield Object(R.e)(t);const s=yield r[0].loadBytes();e=yield i.d.fromBytes(s);const a=e.img;n=a.width,o=a.height}this.addLogoCore(e,n,o)})))}}catch(e){alert("It seems that we cannot load this image. Please try another one.");const t=new Error("Adding logo failed: "+e);Object(s.lb)(t,!0)}}))}get watchChanges(){return this._watchChanges}set watchChanges(e){this._watchChanges!=e&&(this._watchChanges=e,e?0===this.saveSettingsFrequency?this.taskObserverDisposer=Object(a.d)("save proxies to task",this.saveSettings):this.taskObserverDisposer=Object(a.e)("save proxies to task",this.saveSettings,this.saveSettingsFrequency):(this.taskObserverDisposer&&this.taskObserverDisposer(),this.taskObserverDisposer=null))}highlightItems(){this.imagePreview?(this.watermarkHighlights=this.proxies.map(e=>({rect:e.bounds.grow(10,10),rotation:e.item.rotation})),setTimeout(()=>{this.watermarkHighlights=[]},1500)):this.pendingHighlightItems=!0}loadSettings(e){return Z(this,void 0,void 0,(function*(){this.selectedProxyIndex=-1,yield this.task.loadSettings(e),yield this.getProxiesFromTask(),this.highlightItems()}))}selectProxyAsync(e,t,n){setTimeout(()=>{this.setSelectedProxy(e,t,n)},A.SELECT_PROXY_ASYNC_DELAY)}setSnappedZones(e){this.snappedZones.length>0&&this.snappedZones.splice(0,this.snappedZones.length),e&&e.length>0&&this.snappedZones.push.apply(this.snappedZones,e)}getProxyDraggingImpl(e){if(!e)throw new Error("proxy shouldn't be null");let t=e.draggingImpl;if(!t){const o=25;let r,l,c,d,m,p=!1,u=!1,g=[];function n(e,t,n){if((!p||!u)&&e.distanceToPt(m[t],m[n])<=o){const i=e.snap(m[t],m[n]);i.snappedX==p&&i.snappedY==u||(m[t]=i.x,m[n]=i.y,p=p||i.snappedX,u=u||i.snappedY,(i.snappedX||i.snappedY)&&g.push(e))}}t=new N.a({onDragStart:()=>{const t=this.proxies,n=this.imageSize;if(r=e.bounds.clone(),m||(m=new s.c),l=e.bounds.centerX,c=e.bounds.centerY,e.dragging=!0,e.item.tile===i.i.none){const i=n.min/40;if(d=[new h.a(0,0,n.width-1,0,!1,!0),new h.a(0,n.height-1,n.width-1,n.height-1,!1,!0),new h.a(0,0,0,n.height-1,!0,!1),new h.a(n.width-1,0,n.width-1,n.height-1,!0,!1),new h.a(i,i,n.width-i,i,!1,!0),new h.a(i,n.height-i,n.width-i,n.height-i,!1,!0),new h.a(i,i,i,n.height-i,!0,!1),new h.a(n.width-i,i,n.width-i,n.height-i,!0,!1),new h.a(n.width/2,0,n.width/2,n.height-1,!0,!1),new h.a(0,n.height/2,n.width-1,n.height/2,!1,!0)],t.length>1)for(let i=t.length-1;i>=0;i--){const o=t[i];if(o!==e){const e=o.bounds;d.push(new h.a(0,e.centerY,n.width,e.centerY,!1,!0),new h.a(0,e.y,n.width,e.y,!1,!0),new h.a(0,e.bottom,n.width,e.bottom,!1,!0),new h.a(e.centerX,0,e.centerX,n.height-1,!0,!1),new h.a(e.x,0,e.x,n.height-1,!0,!1),new h.a(e.right,0,e.right,n.height-1,!0,!1))}}}else d=void 0;this.snappedZones=[]},onDragEnd:()=>{if(e.dragging=!1,Math.abs(e.bounds.centerX-l)<3&&Math.abs(e.bounds.centerY-c)<3){let n,i;t.parentElemBounds&&(n=t.clientX-t.parentElemBounds.left,i=t.clientY-t.parentElemBounds.top),this.selectProxyAsync(e,n,i)}this.snappedZones=[]},canStartDragging:()=>this.allowSelection,onDrag:Object(a.c)((t,i,o,s,a)=>{m.assignFrom(r),m.x+=t,m.y+=i;const l=this.imageSize;if(m.x=Math.max(-r.width/2,m.x),m.x=Math.min(l.width-r.width/2,m.x),m.y=Math.max(-r.height/2,m.y),m.y=Math.min(l.height-r.height/2,m.y),g.length>0&&g.splice(0,g.length),d&&d.length>0&&!o&&!a){p=!1,u=!1;for(let e=0,t=d.length;e<t;e++){const t=d[e];if(n(t,"centerX","centerY"),n(t,"x","y"),n(t,"x","centerY"),n(t,"x","bottom"),n(t,"centerX","y"),n(t,"centerX","bottom"),n(t,"right","y"),n(t,"right","centerY"),n(t,"right","bottom"),p&&u)break}}this.setSnappedZones(g),e.bounds=0!=t||0!=i?m.toRect():r})}),e.draggingImpl=t}return t}}A.SELECT_PROXY_ASYNC_DELAY=10,V([a.l.ref],A.prototype,"proxies",void 0),V([a.l],A.prototype,"imageSize",void 0),V([a.l],A.prototype,"naturalImageSize",void 0),V([a.f],A.prototype,"imageScale",null),V([a.l],A.prototype,"imagePreview",void 0),V([a.l],A.prototype,"_selectedProxyIndex",void 0),V([a.l],A.prototype,"_loadingCounter",void 0),V([a.l.shallow],A.prototype,"watermarkHighlights",void 0),V([a.l.shallow],A.prototype,"snappedZones",void 0),V([a.f],A.prototype,"isLoading",null),V([a.f],A.prototype,"selectedProxy",null),V([a.f],A.prototype,"isDragging",null),V([a.c.bound],A.prototype,"beginLoading",null),V([a.c.bound],A.prototype,"endLoading",null),V([a.c.bound],A.prototype,"removeProxy",null),V([a.c.bound],A.prototype,"removeAllProxies",null),V([a.c.bound],A.prototype,"addProxy",null),V([a.c.bound],A.prototype,"removeItem",null),V([a.f],A.prototype,"removeWatermarkActionName",null),V([a.c.bound],A.prototype,"addText",null),V([a.c.bound],A.prototype,"addLogo",null),V([a.c.bound],A.prototype,"highlightItems",null),V([a.c.bound],A.prototype,"setSnappedZones",null);const G=(()=>{let e=0;const t=new WeakMap;return n=>(t.has(n)||t.set(n,++e),t.get(n))})();function _(e,t,n,r){const a=[],c=[];for(let d=0,h=e.length;d<h;d++){const h=e[d],m=h.item,p=G(m),u="item-filter-"+p+"-"+m.filter,g=s.Z?"item-component-"+p+"-"+u:"item-component-"+p;let f;const b=Object(l.b)(m);if(b)if(b.color instanceof z.a)f=b.color.hexString;else if(b.color instanceof z.b){const e="fill-"+p+"-"+b.color.id;f="url(#"+e+")",a.push(o.createElement(B.a,{key:e,id:e,gradient:b.color}))}else f="";else f="";const y={proxy:h,proxies:e,selfContained:r||!1,id:g,filterId:u,fill:f,bounds:null,imageSize:t,draggingImpl:n&&n(h)};a.push(o.createElement(i.e,{proxy:h,id:u,key:u+"-def"})),m.tile!=i.i.none?c.push(o.createElement(J.c,Object.assign({key:g},y))):c.push(o.createElement(J.a,Object.assign({key:g},y)))}return{defs:a,comps:c}}let Y=class extends o.Component{render(){const e=this.props.model;if(!e.proxies)throw Error("Not-ready model");const t=_(e.proxies,e.imageSize,e.getProxyDraggingImpl);return o.createElement(o.Fragment,null,o.createElement("defs",null,t.defs),t.comps)}};function X(e,t,n){return t>=e.left&&t<e.left+e.width&&n>=e.top&&n<e.top+e.height}Y=V([r.a],Y);let W=class extends o.Component{constructor(e){super(e),this.reconsiderPreview=this.reconsiderPreview.bind(this),this.onWindowResize=this.onWindowResize.bind(this),this.deselectProxy=this.deselectProxy.bind(this),this.renderHighlight=this.renderHighlight.bind(this),this.setSurfaceContainerElem=this.setSurfaceContainerElem.bind(this),this.onTemplatePreviewClicked=this.onTemplatePreviewClicked.bind(this),this.onFileDrop=this.onFileDrop.bind(this),this.delayedReconsiderPreview=e.model.isMobile?this.reconsiderPreview:Object(s.B)(this.reconsiderPreview,1e3),this.dropHandler=!e.model.isMobile&&new U.b(this.onFileDrop),this.draggingImpl=this.createDraggingImpl(e)}get isDragging(){return this.props.model.isDragging}get templatesVisible(){const e=this.props.model;return!e.isLoading&&e.imageSize.width>0&&0==e.proxies.length}get surfaceContainerSize(){let e=this.surfaceContainerElem?this.surfaceContainerElem.offsetWidth:0,t=this.surfaceContainerElem?this.surfaceContainerElem.offsetHeight:0;if(this.props.model.isMobile&&!1!==this.props.reduceSurfaceSizeByActionsSize&&this.mobileActionsContainer){let e=this.mobileActionsContainer.getBoundingClientRect(),n=this.surfaceContainerElem.getBoundingClientRect();n.top<e.top&&(t=e.top-n.top-10)}return new s.i(e,t)}createDraggingImpl(e){let t=null,n=null,i=null;const o=new N.a({onDragStart:()=>{if(n.clientX=o.clientX,n.clientY=o.clientY,n.elem=i,n.parentElem=this.svgElem,n.parentElemBounds=this.svgElem.getBoundingClientRect(),n.handler.onDragStart(),!t.dragging)throw new Error("proxy dragging should be updated")},onDrag:(e,t,i,r,s)=>{n.clientX=o.clientX,n.clientY=o.clientY,n.handler.onDrag(e,t,i,r,s)},onDragEnd:()=>{n.clientX=o.clientX,n.clientY=o.clientY,n.handler.onDragEnd(),t=null,n=null,i=null},canStartDragging:(o,r,a)=>{if(!this.svgElem)return Object(s.lb)(new Error("<svg> element not found"),!0),!1;if(!e.model.allowSelection)return!1;let l=this.svgElem.getBoundingClientRect(),c=!1;if(X(l,r,a))for(let o=1,d=this.svgElem.children.length;o<d;o++){const d=this.svgElem.children.item(o),h=d.dataset&&parseInt(d.dataset.proxyId);if(h>=0){let o;if(l=d.getBoundingClientRect(),d.dataset.extendedClickZone){const e=Math.max(0,(J.a.MIN_TOUCH_ZONE_SIZE-l.width)/2),t=Math.max(0,(J.a.MIN_TOUCH_ZONE_SIZE-l.height)/2);o=r>=l.left-e&&r<l.left+l.width+e&&a>=l.top-t&&a<l.top+l.height+t}else o=X(l,r,a);if(o){if(t=e.model.proxies.find(e=>e.id==h),t){i=d,n=e.model.getProxyDraggingImpl(t),c=!0;break}Object(s.lb)(new s.a("canStartDragging - invalid proxy index",{elem:d.outerHTML,proxyId:h,proxiesId:e.model.proxies.map(e=>e.id)}),!0)}}}return c||this.deselectProxy(),c}});return o}render(){const e=this.props.model,t=e.imageSize,n=this.props.templateLoader;if(!e.proxies)throw Error("Non-ready model");$(e);const i={width:t.width,height:t.height,left:this.surfaceElem?this.surfaceElem.style.left:"0px",top:this.surfaceElem?this.surfaceElem.style.top:"0px"},r=Object(s.w)("watermark-editor",e.isMobile&&"mobile",e.isLoading&&"loading"),a=this.dropHandler&&this.dropHandler.eventHandlers;return o.createElement("div",Object.assign({className:r},a),o.createElement("div",{className:"surface-container",ref:this.setSurfaceContainerElem},o.createElement("div",{className:"deselect-cover",onClick:this.deselectProxy}),o.createElement("div",{className:"surface",style:i},o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:t.width,height:t.height},this.draggingImpl.events),o.createElement("image",{href:e.imagePreview,x:"0",y:"0",width:t.width+"px",height:t.height+"px",className:Object(s.w)("image-preview",t.width>0&&"visible")}),e.watermarkHighlights.length>0&&e.watermarkHighlights.map(this.renderHighlight),o.createElement(J.b,{owner:e}),o.createElement(Y,{model:e,selectProxy:e.selectProxyAsync}),o.createElement(ie,{model:e})))),o.createElement(ne,{model:e,width:this.itemOptionsWidth,templateLoader:n,onTemplatePreviewClicked:this.onTemplatePreviewClicked,visible:this.templatesVisible}),e.isLoading&&o.createElement(b.c,null),!!n&&o.createElement(M,{templateLoader:n,visible:this.templatesVisible,vertical:!1,onPreviewClicked:this.onTemplatePreviewClicked}),!0!==this.props.disableDropCover&&this.dropHandler&&o.createElement(U.a,{dropHandler:this.dropHandler}))}reconsiderPreview(){return this.props.model.reconsiderPreview(this.surfaceContainerSize)}componentDidMount(){const e=this.props.model;window.addEventListener("resize",this.onWindowResize),e.watchChanges=!0,setTimeout(()=>{this.reconsiderPreview()},1)}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize),this.props.model.watchChanges=!1}onWindowResize(){this.delayedReconsiderPreview(),this.props.model.isTouch||this.props.model.setSelectedProxy(null)}deselectProxy(){this.props.model.setSelectedProxy(null)}renderHighlight(e,t){const n=e.rect,i=Object(J.e)(e.rotation,n);return o.createElement("rect",{x:n.x,y:n.y,rx:5,ry:5,transform:i,width:n.width,height:n.height,fill:"#ffffff",key:"watermark-highlight-"+t},o.createElement("animate",{attributeName:"opacity",values:"0;1;0",dur:"300ms",repeatCount:"indefinite"}))}setSurfaceContainerElem(e){this.surfaceContainerElem=e,e?(this.surfaceElem=e.querySelector(".surface"),this.itemOptionsElem=e.parentNode.querySelector(".item-options"),this.svgElem=e.querySelector("svg")):(this.surfaceElem=null,this.itemOptionsElem=null,this.svgElem=null),this.mobileActionsContainer=document.body.querySelector(".wizard .mobile-actions-container"),this.forceUpdate()}onTemplatePreviewClicked(e){return Z(this,void 0,void 0,(function*(){yield this.loadTemplate(e)}))}loadTemplate(e){return Z(this,void 0,void 0,(function*(){const t=yield this.props.templateLoader.get(e);yield this.props.model.loadSettings(t)}))}onFileDrop(e){return Object(D.m)(()=>Z(this,void 0,void 0,(function*(){let t=!1;const n=this.props.templateLoader;for(let o=0;o<e.length;o++){if("file"===e[o].kind){const r=e[o].getAsFile();if(r)if(r.name.endsWith(".watermarkly")||r.name.endsWith(".json"))yield Object(v.c)(n,r),t=!0;else if(Object(s.Q)(Object(s.mb)(r.name))){const e=yield Object(s.gb)(r),t=yield i.d.fromBytes(e),{width:n,height:o}=t.img;this.props.model.addLogoCore(t,n,o)}}}if(t){(yield n.count())>0&&(yield this.loadTemplate(0))}})))}};V([a.l],W.prototype,"itemOptionsWidth",void 0),W=V([r.a],W);const q=10;function K(e,t,n,i,o,r){if(!i||i.empty)return{imagePos:new s.d,optionsPos:new s.d};const a=t.width,l=t.height,c=(a-i.width)/2,d=(l-i.height)/2,h=new s.d;let m;if(h.x=c,h.y=d,0!==o.height&&0!==o.width&&r){m=function(e,t,n,i,o,r){if(t.empty)return console.warn("calculateOptionsPosition: proxyBounds are empty, returning empty position."),new s.d;if(e){let e,t=0;const i=Math.min(n.height,.6*o.height);return e=n.height+r.height+q<o.height?(o.height-r.height-n.height-q)/2+r.height+q:o.height-r.height>i?r.height+q:.4*o.height,new s.d(t,e)}{const e=30,a=i.width,l=i.height,c=(a-r.width)/2,d=(l-r.height)/2,h=l-t.bottom-d,m=t.y+d,p=a-t.right-c,u=t.x+c;let g,f;return h>=n.height?(g=t.x+c,f=t.bottom+d,h>n.height&&(f+=Math.min(e,h-n.height))):m>=n.height?(g=t.x+c,f=t.y-n.height+d,m>n.height&&(f-=Math.min(e,m-n.height))):p>=n.width?(g=t.right+c,p>n.width&&(g+=Math.min(e,p-n.width)),f=t.y+d):u>=n.width?(g=t.x-n.width+c,u>n.width&&(g-=Math.min(e,u-n.width)),f=t.y+d):(g=t.right+c,p<n.width&&(g+=p-n.width),f=t.y+d),g=Object(s.nb)(g,0,o.width-n.width-1),f=Object(s.nb)(f,0,o.height-n.height-1),new s.d(g,f)}}(e,o,r,t,n,i);let a=m.x-c,l=m.y-d,p=o.intersect(new s.g(a,l,r.width,r.height));if(!e&&p&&o.width<i.width&&o.height<i.height&&(h.y-=o.bottom-l+30,h.y=Math.max(h.y,-o.y)),e){const e=m.y;i.height<e?h.y=m.y-i.height-q:o.centerY<i.height/3||i.height<e?h.y=0:o.centerY>2*i.height/3?h.y=-i.height+e:h.y=(e-i.height)/2}}else m=new s.d;return{optionsPos:m,imagePos:h}}function $(e){const t=e.selectedProxy;return!!t&&!t.dragging&&e.imageSize.width>0}function ee(e){return o.Children.toArray(e.children)[0]||null}let te,ne=class extends o.Component{constructor(e){super(e),this.pendingValidatePosition=0,this.constraintsSetFor=null,this.scaleConstraints={anchorX:i.a.begin,anchorY:i.a.begin},this.onStartScaleChanging=this.onStartScaleChanging.bind(this),this.onEndScaleChanging=this.onEndScaleChanging.bind(this),this.updateScaleConstraints=this.updateScaleConstraints.bind(this),this.validatePosition=this.validatePosition.bind(this),this.onChangeColor=this.onChangeColor.bind(this),this.onTextChange=this.onTextChange.bind(this),this.onAddCopyrightSymbol=this.onAddCopyrightSymbol.bind(this),this.onAddImageNumber=this.onAddImageNumber.bind(this),this.onInputFocused=this.onInputFocused.bind(this),this.onLineHeightChange=this.onLineHeightChange.bind(this),this.onAlignmentClick=this.onAlignmentClick.bind(this),this.onFontChange=this.onFontChange.bind(this),this.onInputLostFocus=this.onInputLostFocus.bind(this),this.onRemoveClicked=this.onRemoveClicked.bind(this),this.onRemoveBackgroundClicked=this.onRemoveBackgroundClicked.bind(this),this.setRef=this.setRef.bind(this),this.setInputRef=this.setInputRef.bind(this),Object(p.e)(),this.draggingSizeSlider=!1,this.wasMounted=!1,te=this}get surfaceContainer(){if(!this._surfaceContainer&&this.elem){let e=this.elem.parentElement.querySelector(".surface-container");this._surfaceContainer=e}return this._surfaceContainer}get surfaceElem(){return this._surfaceElem||(this._surfaceElem=this.surfaceContainer?this.surfaceContainer.querySelector(".surface"):null),this._surfaceElem}get position(){const e=this.elem;return e&&""!=e.style.left?new s.d(parseInt(e.style.left),parseInt(e.style.top)):null}set position(e){const t=this.elem;if(t){const n=this.surfaceContainer;e&&(e.x+t.offsetWidth>n.offsetWidth&&(e.x=n.offsetWidth-t.offsetWidth),!this.props.model.isMobile&&e.y+t.offsetHeight>n.offsetHeight&&(e.y=n.offsetHeight-t.offsetHeight),e.x<0&&(e.x=0),e.y<0&&(e.y=0));let i=this.position;i&&i.equals(e)||(e?(t.style.left=e.x+"px",t.style.top=e.y+"px"):(t.style.left="",t.style.top=""))}}get isVisible(){return!!this.elem&&$(this.props.model)}onStartScaleChanging(){this.draggingSizeSlider=!0}onEndScaleChanging(){this.draggingSizeSlider=!1,this.validatePosition()}render(){const e=this.props,t=e.model.proxies;e.model.imageSize;if(e.model.selectedProxy){e.model.selectedProxy.bounds}const n=Object(s.w)("item-options",!this.proxy&&t.length>0&&"empty",!this.isVisible&&"hidden",e.model.onlyScaleEditor&&"only-scale-editor",e.model.isMobile&&"with-shadow",s.Hb&&"test-mode");let i=this.draggingImpl&&this.draggingImpl.events;return o.createElement("div",Object.assign({className:n,ref:this.setRef},i),o.createElement("table",null,o.createElement("tbody",null,this.renderProxyOptions(this.proxy))))}componentDidMount(){this.wasMounted=!0,this.validatePosition(),this.proxyReactionDisposer=Object(a.d)(()=>{const e=this.props.model.selectedProxy;e||s.Hb?this.proxy=e:setTimeout(()=>this.proxy=null,200)})}componentWillUnmount(){this.proxyReactionDisposer&&(this.proxyReactionDisposer(),this.proxyReactionDisposer=void 0),this.wasMounted=!1}componentDidUpdate(){this.draggingSizeSlider||this.props.model.isDragging||this.validatePosition(),this.updateScaleConstraints(),this.isVisible||(this.constraintsSetFor=null)}updateScaleConstraints(){const e=this.props.model,t=e.selectedProxy,n=e.imageSize;this.constraintsSetFor!==t&&(this.constraintsSetFor=t,t&&(this.scaleConstraints.anchorX=Object(i.k)(t.bounds.width,t.bounds.centerX,n.width),this.scaleConstraints.anchorY=Object(i.k)(t.bounds.height,t.bounds.centerY,n.height)))}validatePosition(){if(this.pendingValidatePosition&&(clearTimeout(this.pendingValidatePosition),this.pendingValidatePosition=null),!this.wasMounted)return;const e=this.elem,t=this.props.model,n=t.selectedProxy,i=this.isVisible;if(t.isMobile&&!i&&e&&e.classList.contains("animate-top")&&e.classList.remove("animate-top"),!e||!this.surfaceElem||i&&e.offsetWidth<200||n&&(!n.bounds||n.bounds.empty))return console.log("proxyBounds weren't calculated yet, retry after a delay"),void(this.pendingValidatePosition=setTimeout(()=>{this.validatePosition()},10));this.pendingValidatePosition=0,this.elem.style.maxHeight="fit-content";const o=new s.i(this.surfaceContainer),r=K(t.isMobile,t.containerSize,o,t.imageSize,n?n.bounds:new s.g,new s.i(e));this.surfaceElem.style.left=r.imagePos.x+"px",this.surfaceElem.style.top=r.imagePos.y+"px",this.position=r.optionsPos,r.optionsPos.y+this.elem.offsetHeight>o.height&&(this.elem.style.maxHeight="100%"),t.isMobile&&i&&!e.classList.contains("animate-top")&&e.classList.add("animate-top")}onChangeColor(e){const t=this.props.model.selectedProxy,n=Object(l.b)(t&&t.item);n&&(n.allowNullColor&&null===e?n.color=null:n.color=e)}onTextChange(e){const t=this.props.model.selectedProxy;t.item instanceof i.h&&(t.item.text=e.target.value)}onAddCopyrightSymbol(e){e.preventDefault();const t=this.textElem.selectionEnd,n=this.props.model.selectedProxy;if(n.item instanceof i.h){const e=n.item.text.substring(0,t),i=n.item.text.substring(t);n.item.text=e+" Â© "+i}}onAddImageNumber(e){e.preventDefault();const t=this.textElem.selectionEnd,n=this.props.model.selectedProxy;if(n.item instanceof i.h){const e=n.item.text.substring(0,t),i=n.item.text.substring(t);n.item.text=e+" <number:1> "+i}}onInputFocused(e){if(this.inputFocused=!0,this.props.model.isMobile){const t=e.target,n=document.createElement("div"),i=()=>{n.removeEventListener("click",i,!1),t.removeEventListener("focusout",i,!1),n.remove()};Object.assign(n.style,{position:"absolute",left:"0",top:"0",right:"0",bottom:"0",zIndex:"1"}),n.addEventListener("click",i,!1),t.addEventListener("focusout",i,!1),document.body.appendChild(n)}}onLineHeightChange(e){const t=this.props.model.selectedProxy;t.item instanceof i.h&&(t.item.lineHeight=e/50+1)}onAlignmentClick(e){const t=this.props.model.selectedProxy;if(t.item instanceof i.h)switch(e){case 0:t.item.alignment=i.c.left;break;case 1:t.item.alignment=i.c.center;break;case 2:t.item.alignment=i.c.right}}onFontChange(e){return Z(this,void 0,void 0,(function*(){if(e)if(Object(s.u)(),g.l.get()!=g.s&&e.edition>g.l.get())Object(m.c)(e.edition);else if(e.family){const t=this.props.model;t.beginLoading();try{yield function(e,t){const n=e.map(e=>e.item.fontName);t&&n.push(t);return Object(p.g)(n)}(t.proxies,e.family)}finally{t.selectedProxy.item.fontName=e.family,t.endLoading()}}}))}onInputLostFocus(){this.inputFocused=!1}onRemoveClicked(){this.props.model.selectedProxy?this.props.model.removeProxy(this.props.model.selectedProxy):this.props.model.removeAllProxies()}onRemoveBackgroundClicked(){this.proxy.item.removeBackground()}renderProxyOptions(e){const t=this.props.model,n=t.imageSize,r=t.imageScale,a=t.onlyScaleEditor,h=t.onlyOpacityEditor;if(e&&a&&h)return o.createElement(o.Fragment,null,o.createElement("tr",null,o.createElement("td",null,Object(f.c)("size")),o.createElement("td",null,o.createElement(c.c,{proxy:e,imageSize:n,imageScale:r,constraints:this.scaleConstraints,onStartScaleChanging:this.onStartScaleChanging,onEndScaleChanging:this.onEndScaleChanging}))),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("opacity")),o.createElement("td",null,o.createElement(c.a,{proxy:e}))));if(e&&e.item instanceof i.h){const a=e.item.text.lineBreaksCount()+1;let h=0;switch(e.item.alignment){case i.c.center:h=1;break;case i.c.right:h=2}return o.createElement(o.Fragment,null,o.createElement("tr",null,o.createElement("td",{className:"name-center"},Object(f.c)("text")),o.createElement("td",null,o.createElement("textarea",{className:"text-input",onChange:this.onTextChange,onFocus:this.onInputFocused,onBlur:this.onInputLostFocus,ref:this.setInputRef,style:a>1?{height:20*a+"px"}:{},value:e.item.text}))),o.createElement(T.a,{component:ee,transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},this.inputFocused?o.createElement("tr",null,o.createElement("td",null),o.createElement("td",null,o.createElement("div",{className:Object(s.w)("add-symbol button-group",s.V&&"mobile")},o.createElement("button",{onMouseDown:s.V?void 0:this.onAddCopyrightSymbol,onTouchEnd:s.V?this.onAddCopyrightSymbol:void 0},"+ ",o.createElement("span",null,"Â©")),t.showImageNumber&&o.createElement("button",{onMouseDown:s.V?void 0:this.onAddImageNumber,onTouchEnd:s.V?this.onAddImageNumber:void 0},"+ ",Object(f.c)("image-number"))))):null),o.createElement(T.a,{component:ee,transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},a>1?o.createElement("tr",null,o.createElement("td",null,Object(f.c)("horizontal-alignment")),o.createElement("td",null,o.createElement(w.a,{selectedIndex:h,buttons:[{children:o.createElement(x.a,{src:H})},{children:o.createElement(x.a,{src:F})},{children:o.createElement(x.a,{src:Q})}],onClick:this.onAlignmentClick}))):null),o.createElement(T.a,{component:ee,transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},a>1?o.createElement("tr",null,o.createElement("td",null,Object(f.c)("line-height")),o.createElement("td",null,o.createElement(y.a,{value:50*(e.item.lineHeight-1),onChange:this.onLineHeightChange}))):null),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("font")),o.createElement("td",null,o.createElement(d.a,{textObject:e.item,onChange:this.onFontChange}))),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("color")),o.createElement("td",null,o.createElement("div",{className:"short-container"},o.createElement(l.a,{obj:e.item,onChange:this.onChangeColor})))),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("size")),o.createElement("td",null,o.createElement(c.c,{proxy:e,imageSize:n,imageScale:r,constraints:this.scaleConstraints,onStartScaleChanging:this.onStartScaleChanging,onEndScaleChanging:this.onEndScaleChanging}))),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("tile")),o.createElement("td",null,o.createElement(c.e,{proxy:e,imageSize:n}))),o.createElement(T.a,{component:ee,transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},e.item.tile!=i.i.none?o.createElement("tr",null,o.createElement("td",null,"Span"),o.createElement("td",null,o.createElement(c.d,{proxy:e,imageSize:n}))):null),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("opacity")),o.createElement("td",null,o.createElement(c.a,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{className:"name-center"},Object(f.c)("rotation")),o.createElement("td",null,o.createElement(c.b,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{className:"effect"},Object(f.c)("effect")),o.createElement("td",null,o.createElement(u.a,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{colSpan:2},o.createElement("button",{className:"remove-button",onClick:this.onRemoveClicked},o.createElement("span",{className:"trash-bin-icon"},"ï­"),Object(f.c)("remove-text-action")))))}return e&&e.item instanceof i.d?o.createElement(o.Fragment,null,e.item.opaque&&o.createElement("tr",null,o.createElement("td",{colSpan:2},o.createElement("button",{className:"remove-background",onClick:this.onRemoveBackgroundClicked},Object(f.c)("remove-background-action")))),!e.item.opaque&&o.createElement("tr",null,o.createElement("td",null,Object(f.c)("color")),o.createElement("td",null,o.createElement("div",{className:"short-container"},o.createElement(l.a,{obj:e.item,onChange:this.onChangeColor})))),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("size")),o.createElement("td",null,o.createElement(c.c,{proxy:e,imageSize:n,imageScale:r,constraints:this.scaleConstraints,onStartScaleChanging:this.onStartScaleChanging,onEndScaleChanging:this.onEndScaleChanging}))),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("tile")),o.createElement("td",null,o.createElement(c.e,{proxy:e,imageSize:n}))),o.createElement(T.a,{component:ee,transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},e.item.tile!=i.i.none?o.createElement("tr",null,o.createElement("td",null,"Span"),o.createElement("td",null,o.createElement(c.d,{proxy:e,imageSize:n}))):null),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("opacity")),o.createElement("td",null,o.createElement(c.a,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{className:"name-center"},Object(f.c)("rotation")),o.createElement("td",null,o.createElement(c.b,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{className:"effect"},Object(f.c)("effect")),o.createElement("td",null,o.createElement(u.a,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{colSpan:2},o.createElement("button",{className:"remove-button",onClick:this.onRemoveClicked},o.createElement("span",{className:"trash-bin-icon"},"ï­"),Object(f.c)("remove-logo-action"))))):e&&(e.item instanceof i.b||e.item instanceof i.g)?o.createElement(o.Fragment,null,o.createElement("tr",null,o.createElement("td",null,Object(f.c)("color")),o.createElement("td",null,o.createElement("div",{className:"short-container"},o.createElement(l.a,{obj:e.item,onChange:this.onChangeColor})))),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("size")),o.createElement("td",null,o.createElement(c.c,{proxy:e,imageSize:n,imageScale:r,constraints:this.scaleConstraints,onStartScaleChanging:this.onStartScaleChanging,onEndScaleChanging:this.onEndScaleChanging}))),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("tile")),o.createElement("td",null,o.createElement(c.e,{proxy:e,imageSize:n}))),o.createElement(T.a,{component:ee,transitionEnter:!0,transitionLeave:!0,transitionName:"item-option",transitionEnterTimeout:300,transitionLeaveTimeout:250},e.item.tile!=i.i.none?o.createElement("tr",null,o.createElement("td",null,"Span"),o.createElement("td",null,o.createElement(c.d,{proxy:e,imageSize:n}))):null),o.createElement("tr",null,o.createElement("td",null,Object(f.c)("opacity")),o.createElement("td",null,o.createElement(c.a,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{className:"name-center"},Object(f.c)("rotation")),o.createElement("td",null,o.createElement(c.b,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{className:"effect"},Object(f.c)("effect")),o.createElement("td",null,o.createElement(u.a,{proxy:e}))),o.createElement("tr",null,o.createElement("td",{colSpan:2},o.createElement("button",{className:"remove-button",onClick:this.onRemoveClicked},o.createElement("span",{className:"trash-bin-icon"},"ï­"),Object(f.c)("remove-logo-action"))))):void 0}setRef(e){this.elem=e,this._surfaceContainer=null}setInputRef(e){this.textElem=e,this._surfaceContainer=null}};V([a.l],ne.prototype,"proxy",void 0),V([a.l],ne.prototype,"inputFocused",void 0),ne=V([r.a],ne);let ie=class extends o.Component{constructor(e){super(e),this.bounds=new s.c}render(){const e=this.props.model.selectedProxy,t=!!e;t?(this.bounds.assignFrom(e.bounds),this.bounds.grow(3,3)):this.bounds.reset();const n=t?Object(J.e)(e.item.rotation,this.bounds):"";return o.createElement("rect",{className:"selection",transform:n,x:this.bounds.x,y:this.bounds.y,width:this.bounds.width,height:this.bounds.height})}};ie=V([r.a],ie)},43:function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return I})),n.d(t,"c",(function(){return M})),n.d(t,"d",(function(){return P})),n.d(t,"e",(function(){return T}));var i=n(1),o=n(14),r=n(15),s=n(4),a=n(58),l=n(24),c=n(11),d=n(3),h=n(16),m=n(7),p=n(2),u=n(9),g=n(12),f=n(10),b=n(33),y=n(68),w=function(e,t,n,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(r<3?o(s):r>3?o(t,n,s):o(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s},x=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const v=n(96);function E(){if(i.Hb||localStorage.getItem("notification-about-syncing"))return;localStorage.setItem("notification-about-syncing","true");let e="";["fr","it","ko","ru"].indexOf(Object(p.b)())>=0&&(e=Object(p.b)()+"/");let t="https://watermarkly.com/"+e+"blog/template-sync/";const n=Object(m.h)({position:"center",title:Object(p.c)("new-feature"),children:Object(p.c)("sync-feature-notification-text"),buttons:[{onClick:()=>n.close(),text:"OK"},{onClick:()=>Object(u.y)(t),text:Object(p.c)("learn-more-action")}]})}i.C&&(window.showNotificationAboutSyncing=E);class k{constructor(e="template-loader-",t=10){this.settingsPrefix=e,this.records=[],this.maxCount=t,this.changeCounter=0,this.subscriptionExpired=!1,this.saveValueKeys=this.saveValueKeys.bind(this),this.onChanged=this.onChanged.bind(this),this.initPromise=this.init()}init(){return x(this,void 0,void 0,(function*(){const e=yield Object(g.i)(this.indexKey());if(e&&Array.isArray(e))for(let t=0;t<e.length;t++)this.records.push({key:e[t],preview:null,settings:null,serverId:null,createdOn:null,synced:Object(d.l)(!1)});let t=!1;for(let e=this.records.length-1;e>=0;e--){const n=this.records[e],o=n.key,r=yield Object(g.i)(this.previewKey(o));if(!(r instanceof Blob)){t=!0,yield this.removeCore(e,!1);continue}n.preview=r;if(!(yield this.getTemplateSettings(n))){t=!0,yield this.removeCore(e,!1);continue}const s=yield Object(g.i)(this.metaKey(o));s?(s.createdOn||(s.createdOn=Object(i.Jb)()),s.createdOn instanceof Date||(s.createdOn&&Object(i.lb)(new Error("recordMeta.createdOn isn't a Date object: "+Object.keys(s.createdOn))),s.createdOn=Object(i.Jb)()),n.serverId=s.serverId,n.createdOn=s.createdOn):(n.serverId=null,n.createdOn=Object(i.Jb)()),n.synced.set(!!n.serverId)}t&&(yield this.saveValueKeys());localStorage.getItem(this.removeDuplicateKeys())||(localStorage.setItem(this.removeDuplicateKeys(),"local"),yield this.removeDuplicates()),this.onChanged()}))}count(){return x(this,void 0,void 0,(function*(){return yield this.initPromise,this.records.length}))}clear(){return x(this,void 0,void 0,(function*(){let e=yield this.count();if(0!=e){for(;e>0;)yield this.removeCore(0,!1),e--;yield this.saveValueKeys(),this.onChanged()}}))}get(e){return x(this,void 0,void 0,(function*(){return yield this.initPromise,this.getCore(e)}))}getCore(e){return x(this,void 0,void 0,(function*(){if(e<0||e>=this.records.length)throw new o.a("index",e);const t=this.records[e],n=yield this.getTemplateSettings(t);return n&&void 0!==n.images&&(delete n.images,delete n.imagesTime),n}))}getTemplateSettings(e){return x(this,void 0,void 0,(function*(){return e.settings||(e.settings=yield Object(g.i)(this.settingsKey(e.key))),e.settings}))}previews(){return x(this,void 0,void 0,(function*(){return yield this.initPromise,this.records.map(e=>({blob:e.preview,synced:e.synced}))}))}indexOf(e){return x(this,void 0,void 0,(function*(){return yield this.initPromise,yield this.indexOfCore(e)}))}indexOfCore(e){return x(this,void 0,void 0,(function*(){for(let t=0;t<this.records.length;t++){const n=this.records[t].settings||(yield this.getCore(t));if(Object(r.g)(n,e))return t}return-1}))}remove(e){return x(this,void 0,void 0,(function*(){yield this.initPromise,this.syncPromise&&(yield this.syncPromise),yield this.removeCore(e,!0),yield this.saveValueKeys(),this.onChanged()}))}removeCore(e,t){return x(this,void 0,void 0,(function*(){if(e<0||e>=this.records.length)throw new o.a("index",e);const n=this.records[e],i=n.key;this.records.splice(e,1),yield Object(g.d)(this.settingsKey(i)),yield Object(g.d)(this.previewKey(i)),yield Object(g.d)(this.metaKey(i)),t&&n.serverId&&this.backend&&(yield this.backend.deleteTemplate(n.serverId))}))}put(e,t=Object(i.Jb)(),n=null){return x(this,void 0,void 0,(function*(){yield this.initPromise;const o=yield this.indexOfCore(e);if(0==o)return;let d;if(o>=0&&(d=this.records[o].preview,yield this.removeCore(o,!1)),!d)if(i.Hb)d=Object(c.b)();else{const t=new r.c;yield t.loadSettings(e),d=yield function(e,t){return x(this,void 0,void 0,(function*(){if(C)return C(e,t);const n=yield function(e,t){return x(this,void 0,void 0,(function*(){const n=e.items.some(e=>e instanceof s.h),o=e.items.some(e=>e instanceof s.b),r=n||o?yield Object(l.d)(o):"",d=function(e,t){const n=e.toProxies(t,!0,0),o=[],r=[],a=[];for(const e of n){const n=Object(s.k)(e.bounds.width,e.bounds.centerX,t.width),i=Object(s.k)(e.bounds.height,e.bounds.centerY,t.height);o.indexOf(n)<0&&o.push(n),r.indexOf(i)<0&&r.push(i),a.push({x:n,y:i})}let l=t.width/3,c=t.height/3;const d=t.width/2,h=t.height/2;1==o.length&&1==r.length?(l=.9*t.width,c=.9*t.height):o.length<=2&&r.length<=2&&o.indexOf(s.a.middle)<0&&r.indexOf(s.a.middle)<0&&(l=d,c=h);let m=0;for(let e=n.length-1;e>=0;e--){const o=n[e],r=a[e];let p=o.bounds.width,u=o.bounds.height;switch(r.x){case s.a.begin:p+=o.bounds.x;break;case s.a.middle:p=2*Math.max(Math.abs(d-o.bounds.right),Math.abs(d-o.bounds.x));break;case s.a.end:p=t.width-o.bounds.x}switch(r.y){case s.a.begin:u+=o.bounds.y;break;case s.a.middle:u=2*Math.max(Math.abs(h-o.bounds.bottom),Math.abs(h-o.bounds.y));break;case s.a.end:u=t.height-o.bounds.y}if(p<0||u<0)return Object(i.lb)(new i.a("Template Preview - Invalid size calculated",{proxyIndex:e,proxyBounds:n.map(e=>e.bounds),previewSize:t}),!0),n;let g=1;p<l&&u<c&&(g=Math.min(l/p,c/u)),(0==m||g<m)&&(m=g)}for(let e=n.length-1;e>=0;e--){const o=n[e],r=a[e],l=m*o.bounds.width,c=m*o.bounds.height;let p,u;switch(r.x){case s.a.begin:p=o.bounds.x*m;break;case s.a.middle:const e=o.bounds.centerX-d;p=d+e*m-l/2;break;case s.a.end:p=t.width-(t.width-o.bounds.right)*m-l}switch(r.y){case s.a.begin:u=o.bounds.y*m;break;case s.a.middle:const e=o.bounds.centerY-h;u=h+e*m-c/2;break;case s.a.end:u=t.height-(t.height-o.bounds.bottom)*m-c}const g=new i.g(p,u,l,c);(p<0||u<0)&&o.bounds.x>=0&&o.bounds.y>=0&&Object(i.lb)(new i.a("Template Preview - Invalid bounds calculated",{proxyIndex:e,calculatedBounds:g.clone(),previewSize:t,originalBounds:n.map(e=>e.bounds.clone())}),!0),o.bounds=g,o.scale*=m}for(let e=n.length-1;e>=0;e--){const t=n[e];t.opacity<.5&&(t.opacity=.5)}return n}(e,t),h=yield Object(a.b)(t,d,r),m=Object(c.m)(t.width,t.height),p=m.getContext("2d");return p.fillStyle=function(e){let t=0;for(const n of e)t+=Object(s.p)(n.item);return t/e.length<150}(d)?"#ffffff":"#000000",p.fillRect(0,0,t.width,t.height),p.drawImage(h,0,0),h.close(),m}))}(e,t),o=yield Object(c.i)(n,"image/jpeg",.8);return n.close(),o}))}(t,O)}yield this.forcePut(d,e,t,n)}))}forcePut(e,t,n=Object(i.Jb)(),o=null){return x(this,void 0,void 0,(function*(){delete t.images,delete t.imagesTime;const r={key:""+Object(i.qb)(),settings:t,preview:e,serverId:o,createdOn:n,synced:Object(d.l)(!!o)};this.records.splice(0,0,r);const s=r.key;yield Object(g.p)(this.settingsKey(s),r.settings),yield Object(g.p)(this.previewKey(s),r.preview);try{this.backend&&!o&&this.maxServerTemplateCount>0&&(yield this.syncPromise,r.serverId=yield this.backend.putTemplate({template:t,createdOn:n,format:1}),r.synced.set(!!r.serverId))}catch(e){Object(i.lb)(e,!0)}yield this.saveRecordMeta(r),this.records.length>this.maxCount&&(yield this.removeCore(this.records.length-1,!1)),yield this.saveValueKeys(),this.onChanged()}))}saveRecordMeta(e){return x(this,void 0,void 0,(function*(){return Object(g.p)(this.metaKey(e.key),{serverId:e.serverId,createdOn:e.createdOn})}))}saveValueKeys(){return this.records.length>0?Object(g.p)(this.indexKey(),this.records.map(e=>e.key)):Object(g.d)(this.indexKey())}onChanged(){this.changeCounter++,this.observableCount=this.records.length}getSyncStates(){return x(this,void 0,void 0,(function*(){return yield this.initPromise,this.records.map(e=>{const t=e.synced.get();if(i.C&&t!==!!e.serverId)throw new Error("Sync state is different from serverId");return t})}))}removeDuplicates(){return x(this,void 0,void 0,(function*(){try{for(let e=this.records.length-1;e>=0;e--){const t=yield this.indexOfCore(this.records[e].settings);t>=0&&t<e&&(yield this.removeCore(t,!0))}}finally{yield this.saveValueKeys(),this.onChanged()}}))}startSync(e){return x(this,void 0,void 0,(function*(){this.backend=e,this.syncPromise=this.doSync(),yield this.syncPromise;const t=localStorage.getItem(this.removeDuplicateKeys());t&&"local"!=t||(localStorage.setItem(this.removeDuplicateKeys(),"server"),yield this.removeDuplicates())}))}doSync(){return x(this,void 0,void 0,(function*(){if(!this.backend)return;const e=e=>x(this,void 0,void 0,(function*(){try{return yield this.backend.getTemplate(e)}catch(e){return null}})),t=e=>this.records.find(t=>t.serverId===e);yield this.initPromise;const n=yield this.backend.templateIds();if(!!n.subscriptionExpired)return void(this.subscriptionExpired=!0);n.maxTemplateCount>0&&0===n.templates.length&&this.records.length>0&&Object(m.d)()&&E();const i=[];i.push.apply(i,this.records);for(let e=n.templates.length-1;e>=0;e--){const o=n.templates[e];if(1!=o.format)continue;t(o.id)||i.push(o)}i.sort((e,t)=>t.createdOn-e.createdOn),this.maxServerTemplateCount=n.maxTemplateCount;for(let t=Math.min(i.length-1,n.maxTemplateCount-1);t>=0;t--){const o=i[t];if(o.key&&this.maxServerTemplateCount>0){if(o.serverId){if(n.templates.find(e=>e.id==o.serverId))continue}const e=o,t=yield this.getTemplateSettings(e);e.serverId=yield this.backend.putTemplate({format:1,createdOn:e.createdOn,template:t}),e.synced.set(!!e.serverId),yield this.saveRecordMeta(e)}else if(!o.key&&o.id){const t=o.id,n=yield e(t);if(n){const e=yield this.indexOfCore(n);if(e>=0){const n=this.records[e];n.serverId?n.serverId!=t&&(yield this.backend.deleteTemplate(t)):(n.serverId=t,n.synced.set(!!n.serverId),yield this.saveRecordMeta(n))}else yield this.put(n,o.createdOn,t)}}}}))}indexKey(){return this.settingsPrefix+"key"}settingsKey(e){return this.settingsPrefix+"settings-"+e}previewKey(e){return this.settingsPrefix+"preview-"+e}metaKey(e){return this.settingsPrefix+"preview-"+e+"-meta"}removeDuplicateKeys(){return this.settingsPrefix+"remove-duplicates"}}let C;w([d.l],k.prototype,"changeCounter",void 0),w([d.l],k.prototype,"observableCount",void 0),w([d.l],k.prototype,"subscriptionExpired",void 0),w([d.c],k.prototype,"onChanged",null);const O=new i.i(300,200),S="https://backend.watermarkly.com";class j{constructor(e,t){this.email=e,this.key=t}templateIds(){return new Promise((e,t)=>{h.get(S+"/api/templates/v1").query({email:this.email,pwd:this.key}).responseType("json").end((n,i)=>{if(n)t(n);else{const n=i.body;if(n.templates){for(let e=0,t=n.templates.length;e<t;e++){const t=n.templates[e];"string"==typeof t.createdOn&&(t.createdOn=new Date(t.createdOn))}e(n)}else t(n?new Error("Server returned unknown object: "+Object.keys(n)):new Error("Server returned empty object"))}})})}deleteTemplate(e){return new Promise((t,n)=>{h.delete(S+"/api/template/v1").query({id:e}).end(e=>{e?n(e):t()})})}getTemplate(e){return new Promise((t,n)=>{h.get(S+"/api/template/v1").query({id:e}).responseType("arraybuffer").end((e,i)=>{if(e)n(e);else{const e=i.body;if(e){const n=v.decode(new Uint8Array(e));t(Object(g.s)(n))}else t(null)}})})}putTemplate(e){return x(this,void 0,void 0,(function*(){const t=v.encode(yield Object(g.r)(e.template));return new Promise((n,i)=>{const o=new Blob([t],{type:"application/octet-stream"});h.post(S+"/api/template/v1").query({email:this.email,pwd:this.key,createdOn:e.createdOn.toISOString(),format:1}).send(o).responseType("text").end((e,t)=>{e?i(e):n(t.text)})})}))}}function I(e,t){return x(this,void 0,void 0,(function*(){const n=yield e.get(t),i={type:"watermarkly-template",version:1,template:yield Object(g.r)(n)};return new Blob([String.fromCharCode(65279),JSON.stringify(i)],{type:"application/watermarkly"})}))}function M(e,t){return x(this,void 0,void 0,(function*(){try{const n=yield Object(i.jb)(t),o=n?JSON.parse(n):{};if(o&&"watermarkly-template"===o.type){const t=o.version;o.template=Object(g.s)(o.template),1===t&&(yield e.put(o.template))}}catch(e){Object(i.lb)(e,!0)}}))}function P(){return x(this,void 0,void 0,(function*(){const e=f.d.get(),t=f.f.get();if(!e||!t)return void Object(i.lb)(new Error("showSubscriptionExpiredNotification shouldn't be called when the app isn't activated"),!0);const n=yield Object(y.b)(Object(p.b)(),i.n,"2-years-templates-synchronization"),o=Object(m.h)({position:"center",doNotCloseOnClick:!0,title:Object(p.c)("subscription-expired"),children:Object(p.c)("template-subscription-expired-message"),buttons:[{onClick:()=>{Object(u.y)("https://backend.watermarkly.com/api/checkout/open/renew-subscription?app="+i.n+"&language="+Object(p.b)()+"&email="+encodeURIComponent(e)+"&key="+encodeURIComponent(t)),o.close()},text:Object(p.c)("renew-subscription",Object(y.a)(n.brutto,n.currency))},{onClick:()=>o.close(),text:Object(p.c)("cancel")}]})}))}function T(e){const t=new b.a("template-subscription-expired-warning-shown",!1,e=>"true"==e);return()=>{const n=f.d.get(),i=f.f.get();n&&i&&(e.startSync(new j(n,i)),e.subscriptionExpired&&!t.get()&&(t.set(!0),P()))}}i.C&&(window.showSubscriptionExpiredNotification=P)},53:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 100 100" version="1.1"><g><circle fill="#000000" cx="50" cy="50" r="15"></circle></g></svg>'},54:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 100 100" version="1.1"><g><circle fill="#000000" cx="25" cy="25" r="15"></circle><circle fill="#000000" cx="75" cy="25" r="15"></circle><circle fill="#000000" cx="25" cy="75" r="15"></circle><circle fill="#000000" cx="75" cy="75" r="15"></circle></g></svg>'},55:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 100 100" version="1.1"><g><circle fill="#000000" cx="50" cy="20" r="15"></circle><circle fill="#000000" cx="20" cy="50" r="15"></circle><circle fill="#000000" cx="80" cy="50" r="15"></circle><circle fill="#000000" cx="50" cy="80" r="15"></circle></g></svg>'},56:function(e,t,n){var i=n(57);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(21)(i,o);i.locals&&(e.exports=i.locals)},57:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".surface svg line.snap-line {\n  stroke: #C822FF;\n  stroke-width: 3px;\n  stroke-dasharray: 5, 5;\n}\n.visualwatermark .surface svg line.snap-line {\n  stroke: #3EB084;\n}\n",""])},58:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b}));var i=n(1),o=n(0),r=n(4),s=n(24),a=n(40),l=n(19),c=n(11),d=n(2),h=n(27),m=n(38),p=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{l(i.next(e))}catch(e){r(e)}}function a(e){try{l(i.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const u=["ZW4scnUsZXMsZGUsZnIscGwsaXQsa28sbmwscHQ=","UHJvdGVjdGVkJTIwd2l0aCUyMGZyZWUlMjB2ZXJzaW9uJTIwb2YlMjAlN0IwJTdELiUyMEZ1bGwlMjB2ZXJzaW9uJTIwZG9lc24ndCUyMHB1dCUyMHRoaXMlMjBtYXJrLiUyQyVEMCU5NyVEMCVCMCVEMSU4OSVEMCVCOCVEMSU4OSVEMCVCNSVEMCVCRCVEMCVCRSUyMCVEMCVCMSVEMCVCNSVEMSU4MSVEMCVCRiVEMCVCQiVEMCVCMCVEMSU4MiVEMCVCRCVEMCVCRSVEMCVCOSUyMCVEMCVCMiVEMCVCNSVEMSU4MCVEMSU4MSVEMCVCOCVEMCVCNSVEMCVCOSUyMCU3QjAlN0QuJTIwJUQwJTlGJUQwJUJFJUQwJUJCJUQwJUJEJUQwJUIwJUQxJThGJTIwJUQwJUIyJUQwJUI1JUQxJTgwJUQxJTgxJUQwJUI4JUQxJThGJTIwJUQwJUJEJUQwJUI1JTIwJUQxJTgxJUQxJTgyJUQwJUIwJUQwJUIyJUQwJUI4JUQxJTgyJTIwJUQxJThEJUQxJTgyJUQwJUJFJTIwJUQwJUJBJUQwJUJCJUQwJUI1JUQwJUI5JUQwJUJDJUQwJUJFLiUyQ1Byb3RlZ2lkbyUyMGNvbiUyMGxhJTIwdmVyc2klQzMlQjNuJTIwZ3JhdHVpdGElMjBkZSUyMCU3QjAlN0QuJTIwTGElMjB2ZXJzaSVDMyVCM24lMjBjb21wbGV0YSUyMG5vJTIwcG9uZSUyMGVzdGElMjBtYXJjYS4lMkNNaXQlMjBkZXIlMjBrb3N0ZW5sb3NlbiUyMFZlcnNpb24lMjB2b24lMjAlN0IwJTdEJTIwZ2VzY2glQzMlQkN0enQuJTIwRGllJTIwVm9sbHZlcnNpb24lMjBzZXR6dCUyMGRpZXNlcyUyMFplaWNoZW4lMjBuaWNodC4lMkNQcm90JUMzJUE5ZyVDMyVBOSUyMGF2ZWMlMjBsYSUyMHZlcnNpb24lMjBncmF0dWl0ZSUyMGRlJTIwJTdCMCU3RC4lMjBMYSUyMHZlcnNpb24lMjBjb21wbCVDMyVBOHRlJTIwbmUlMjBtZXQlMjBwYXMlMjBjZXR0ZSUyMG1hcnF1ZS4lMkNDaHJvbmlvbnklMjBiZXpwJUM1JTgyYXRuJUM0JTg1JTIwd2Vyc2olQzQlODUlMjAlN0IwJTdELiUyMFBlJUM1JTgybmElMjB3ZXJzamElMjBuaWUlMjBzdGF3aWElMjB0ZWdvJTIwem5ha3UuJTJDUHJvdGV0dG8lMjBjb24lMjBsYSUyMHZlcnNpb25lJTIwZ3JhdHVpdGElMjBkaSUyMCU3QjAlN0QuJTIwTGElMjB2ZXJzaW9uZSUyMGNvbXBsZXRhJTIwbm9uJTIwaGElMjBxdWVzdG8lMjBtYXJjaGlvLiUyQyU3QjAlN0QlRUMlOUQlOTglMjAlRUIlQUMlQjQlRUIlQTMlOEMlMjAlRUIlQjIlODQlRUMlQTAlODQlRUMlOUMlQkMlRUIlQTElOUMlMjAlRUIlQjMlQjQlRUQlOTglQjglRUIlOTAlQTklRUIlOEIlODglRUIlOEIlQTQuJTIwJUVDJUEwJTk1JUVDJThCJTlEJTIwJUVCJUIyJTg0JUVDJUEwJTg0JUVDJTlEJTgwJUVDJTlEJUI0JTIwJUVCJUE3JTg4JUVEJTgxJUFDJUVCJUE1JUJDJTIwJUVEJTkxJTlDJUVDJThCJTlDJUVEJTk1JTk4JUVDJUE3JTgwJTIwJUVDJTk1JThBJUVDJThBJUI1JUVCJThCJTg4JUVCJThCJUE0LiUyQ0Jlc2NoZXJtZCUyMG1ldCUyMGRlJTIwZ3JhdGlzJTIwdmVyc2llJTIwdmFuJTIwJTdCMCU3RC4lMjBEZSUyMHZvbGxlZGlnZSUyMHZlcnNpZSUyMHBsYWF0c3QlMjBkZXplJTIwbWFya2VyaW5nJTIwbmlldC4lMkNQcm90ZWdpZG8lMjBjb20lMjBhJTIwdmVycyVDMyVBM28lMjBncmF0dWl0YSUyMGRlJTIwJTdCMCU3RC4lMjBBJTIwdmVycyVDMyVBM28lMjBjb21wbGV0YSUyMG4lQzMlQTNvJTIwY29sb2NhJTIwZXNzYSUyMG1hcmNhLg=="];u[0]=window.atob(u[0]).split(","),u[1]=decodeURIComponent(window.atob(u[1])).split(",");for(let e=0,t=u[0].length;e<t;e++){const t=u[0][e],n=u[1][e];u[t]=n}function g(){return p(this,void 0,void 0,(function*(){let e=g.cachedItem;if(!e){if((i.C||i.Hb)&&!Object.equals(Object.keys(u),Object(d.a)()))throw console.error("Update nag translations.",Object.keys(u),Object(d.a)()),new Error("Update nag translations.");e=new r.h({text:u[Object(d.b)()].replace("{0}",i.o),filter:"shadow-2",alignment:r.c.center,positionBase:new i.i(1e3,1e3)}),g.cachedItem=e;try{const t=yield Object(h.d)(e);e.position=new i.e(0,e.positionBase.width-t.width,0,e.positionBase.height-t.height)}catch(t){Object(i.lb)(t,!0),e.position=new i.e(0,e.positionBase.width-100,0,e.positionBase.height-20)}}return e}))}function f(t,n,s){return new Promise((d,h)=>{e(()=>p(this,void 0,void 0,(function*(){for(const e of n)e.item instanceof r.d&&(e.scale<1||i.R)&&(yield e.item.prepareScaledSrc(e.scale));const e=document.createElement("div");l.render(function(e,t,n){const r=Object(a.c)(t,e,null,!0);return o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:e.width,height:e.height,textRendering:"geometricPrecision",imageRendering:"firefox"==Object(i.s)()?"auto":"optimizeQuality",colorRendering:"optimizeQuality"},o.createElement("defs",null,!!n&&o.createElement("style",{type:"text/css"},n),r.defs),r.comps)}(t,n,s),e,()=>{const t=e.innerHTML;l.unmountComponentAtNode(e);for(const e of n)e.item instanceof r.d&&e.item.resetScaledSrc();Object(c.y)(t).then(d,h)})})))})}delete u[0],delete u[1];class b extends m.a{constructor(e){super(e),this.imageProcessingTimeName="image-watermarking-time"}beforeProcessing(){return p(this,void 0,void 0,(function*(){let e=!1;this.cacheItemsImage=!0;for(let t=this.task.items.length-1;t>=0;t--){const n=this.task.items[t];n instanceof r.b&&(e=!0),n.static||(this.cacheItemsImage=!1)}this.fontsCss=yield Object(s.d)(e)}))}afterProcessing(){this.itemsImage&&(this.itemsImage.close(),this.itemsImage=null)}processImage(e){return p(this,void 0,void 0,(function*(){const t=this.task;if(this.cancelRequested)return null;let n,o,s=t.images[e];try{const a=yield s.loadBytes(),l=yield Object(c.w)(a);if(!l||!l.width)throw new Error("Broken image");if(n=Object(c.s)(l),!n||!n.width)throw new Error("Cannot convert image to canvas");if(n!==l&&l.close(),this.cancelRequested)return null;const d=t.limits.putNag?yield g():null,h=function(e,t,n,o){const s=e.toProxies(new i.i(t),e.autoSize,n);if(o){const e=t.width>=t.height?t.height/40:t.height/80,n=e/o.position.height(o.positionBase.height),a=n*o.position.width(o.positionBase.width);s.push(new r.j({item:o,bounds:new i.g((t.width-a)/2,t.height-2*e,a,e),scale:n,opacity:o.opacity}))}return s}(t,n,e,d);let m;if(this.cacheItemsImage&&this.itemsImage&&this.itemsImage.width==n.width&&this.itemsImage.height==n.height?(m=this.itemsImage,console.log("re-using itemsImage")):m=yield f(new i.i(n),h,this.fontsCss),this.cancelRequested)return null;const p=n.getContext("2d");p.enableSmoothing(),p.drawImage(m,0,0),this.cacheItemsImage?m!=this.itemsImage&&(this.itemsImage&&this.itemsImage.close(),this.itemsImage=m):m.close();const u=t.resize.targetSize(new i.i(n));return o=u.width!=n.width?yield Object(c.A)(n,u,3):n,this.cancelRequested?null:o}finally{n&&n!=o&&(n.close(),n=null)}}))}}}).call(this,n(78).setImmediate)},81:function(e,t,n){var i=n(82);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(21)(i,o);i.locals&&(e.exports=i.locals)},82:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,".templates-component {\n  position: absolute;\n  bottom: 80px;\n  left: 50%;\n  transform: translateX(-50%);\n  background-color: #ffffff;\n  border-radius: 4px;\n  box-shadow: 0 2px 10px 1px rgba(0, 0, 0, 0.2);\n  padding: 20px 10px 10px 10px;\n  transition: opacity 200ms linear;\n  opacity: 0;\n  pointer-events: none;\n  max-width: 80%;\n}\n.templates-component.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n.inline-templates-component {\n  opacity: 0;\n  pointer-events: none;\n  display: flex;\n  flex-direction: column;\n}\n.inline-templates-component h3 {\n  margin: 0 0 10px 10px;\n  font-weight: normal;\n}\n.inline-templates-component.vertical h3 {\n  margin: 0 0 10px 0;\n}\n.inline-templates-component.vertical .templates-container {\n  flex-grow: 2;\n  flex-direction: column;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.inline-templates-component.vertical .templates-container > div.img {\n  width: 300px;\n  margin: 0 10px 10px 10px;\n  position: relative;\n}\n.inline-templates-component.vertical .templates-container > div.img:first-child {\n  margin: 10px;\n}\n.inline-templates-component .templates-container {\n  display: flex;\n  flex-direction: row;\n  overflow-x: auto;\n}\n.inline-templates-component .templates-container > div.img {\n  width: 300px;\n  margin: 10px 10px 10px 0;\n  position: relative;\n}\n.inline-templates-component .templates-container > div.img:first-child {\n  margin: 10px;\n}\n.inline-templates-component .templates-container > div.img > img {\n  width: 300px;\n  transition: box-shadow 200ms linear;\n}\n.inline-templates-component .templates-container > div.img > img:hover {\n  box-shadow: 0 2px 10px rgba(200, 34, 255, 0.6);\n}\n.inline-templates-component .templates-container > div.img > img:active {\n  box-shadow: none;\n}\n.inline-templates-component .templates-container > div.img > .delete-button,\n.inline-templates-component .templates-container > div.img > .download-button {\n  position: absolute;\n  top: 0;\n  right: 0;\n  opacity: 0;\n  pointer-events: none;\n  transition: opacity 0.1s linear, background 0.1s linear;\n  background: #ffffff;\n  border: 1px solid #C0C0C0;\n  padding: 4.5px;\n  width: 36px;\n  height: 36px;\n  border-radius: 18px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.07);\n}\n.inline-templates-component .templates-container > div.img > .delete-button:not(:disabled):not(:active):hover,\n.inline-templates-component .templates-container > div.img > .download-button:not(:disabled):not(:active):hover {\n  background: #ffffff;\n}\n.inline-templates-component .templates-container > div.img > .delete-button:not(:disabled):not(:active):hover,\n.inline-templates-component .templates-container > div.img > .download-button:not(:disabled):not(:active):hover {\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);\n}\n.inline-templates-component .templates-container > div.img > .delete-button.default:not(:disabled):not(:active):hover,\n.inline-templates-component .templates-container > div.img > .download-button.default:not(:disabled):not(:active):hover {\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);\n}\n.inline-templates-component .templates-container > div.img > .delete-button.selected:not(:disabled):not(:active):hover,\n.inline-templates-component .templates-container > div.img > .download-button.selected:not(:disabled):not(:active):hover {\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0);\n}\n.inline-templates-component .templates-container > div.img > .sync-state {\n  position: absolute;\n  bottom: 10px;\n  left: 50%;\n  opacity: 1;\n  pointer-events: none;\n  transform: translateX(-50%);\n  width: 25.2px;\n  height: 25.2px;\n  background: #ffffff;\n  border-radius: 18px;\n}\n.inline-templates-component .templates-container > div.img > .download-button {\n  right: 40px;\n}\n.inline-templates-component .templates-container > div.img > .sync-state {\n  right: 80px;\n}\n.inline-templates-component .templates-container > div.img:hover > .delete-button,\n.inline-templates-component .templates-container > div.img:hover > .download-button,\n.inline-templates-component .templates-container > div.img:hover > .sync-state {\n  opacity: 1;\n  pointer-events: auto;\n}\n.inline-templates-component.visible {\n  opacity: 1;\n  pointer-events: auto;\n}\n.inline-templates-component .expired-warning {\n  padding: 10px 0 0 10px;\n}\n.inline-templates-component .expired-warning span {\n  margin-right: 10px;\n}\n.mobile .templates-component {\n  z-index: 50;\n  padding: 10px;\n  bottom: 200px;\n  max-width: 100%;\n}\n.mobile .templates-component .inline-templates-component {\n  bottom: 160px;\n}\n.mobile .templates-component .inline-templates-component h3 {\n  margin: 0;\n}\n.mobile .templates-component .inline-templates-component .templates-container > div.img {\n  width: auto;\n}\n.mobile .templates-component .inline-templates-component .templates-container > div.img:first-child {\n  margin: 10px 10px 10px 0;\n}\n.mobile .templates-component .inline-templates-component .templates-container > div.img:only-child {\n  margin: 10px 0 0 0;\n}\n.mobile .templates-component .inline-templates-component .templates-container > div.img > img {\n  width: 200px;\n}\n.mobile .templates-component .inline-templates-component .templates-container > div.img > .delete-button {\n  display: none;\n}\n.mobile .templates-component .inline-templates-component .templates-container > div.img > .download-button {\n  display: none;\n}\n.mobile .templates-component .inline-templates-component .expired-warning {\n  padding: 0;\n}\n.mobile .templates-component .inline-templates-component .expired-warning span {\n  display: inline-block;\n  margin: 0 10px 10px 0;\n}\n",""])},83:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" width="64px" height="64px"><linearGradient id="61KRhqZmhJddGRYRcI0Lea" x1="32" x2="32" y1="9.167" y2="54.188" gradientUnits="userSpaceOnUse" spreadMethod="reflect"><stop offset="0" stop-color="#1a6dff"></stop><stop offset="1" stop-color="#c822ff"></stop></linearGradient><path fill="url(#61KRhqZmhJddGRYRcI0Lea)" d="M61,38c0-4.357-3.502-7.912-7.838-7.998C53.714,28.746,54,27.392,54,26 c0-5.514-4.486-10-10-10c-2.836,0-5.471,1.185-7.335,3.206C35.397,13.938,30.632,10,25,10c-6.617,0-12,5.383-12,12 c0,1.373,0.238,2.737,0.697,4.025C7.921,25.616,3,30.256,3,36c0,5.208,4.005,9.495,9.097,9.954C12.544,48.256,14.57,50,17,50h7v-2 h-7c-1.302,0-2.401-0.838-2.815-2H22v-2h-9c-4.411,0-8-3.589-8-8s3.589-8,8-8c0.695,0,1.406,0.099,2.114,0.293l2.292,0.628 l-1.153-2.078C15.434,25.365,15,23.69,15,22c0-5.514,4.486-10,10-10c5.462,0,9.945,4.445,9.995,9.908l0.037,4.057l1.853-3.608 C38.265,19.669,40.991,18,44,18c4.411,0,8,3.589,8,8c0,1.664-0.513,3.265-1.483,4.629l-1.562,2.195l2.615-0.645 C55.512,31.215,59,34.229,59,38c0,3.309-2.691,6-6,6H42v2h9.816c-0.415,1.162-1.514,2-2.816,2h-9v2h9 c2.433,0,4.46-1.749,4.904-4.055C57.891,45.494,61,42.105,61,38z"></path><linearGradient id="61KRhqZmhJddGRYRcI0Leb" x1="32" x2="32" y1="9.167" y2="54.188" gradientUnits="userSpaceOnUse" spreadMethod="reflect"><stop offset="0" stop-color="#1a6dff"></stop><stop offset="1" stop-color="#c822ff"></stop></linearGradient><path fill="url(#61KRhqZmhJddGRYRcI0Leb)" d="M30.251,44.483l-2.294-2.294l-1.414,1.414l2.294,2.294c0.39,0.39,0.901,0.585,1.413,0.585 s1.023-0.195,1.413-0.585l5.794-5.794l-1.414-1.414L30.251,44.483z"></path><linearGradient id="61KRhqZmhJddGRYRcI0Lec" x1="21" x2="21" y1="9.167" y2="54.188" gradientUnits="userSpaceOnUse" spreadMethod="reflect"><stop offset="0" stop-color="#1a6dff"></stop><stop offset="1" stop-color="#c822ff"></stop></linearGradient><path fill="url(#61KRhqZmhJddGRYRcI0Lec)" d="M17,22h2c0-3.309,2.691-6,6-6v-2C20.589,14,17,17.589,17,22z"></path><linearGradient id="61KRhqZmhJddGRYRcI0Led" x1="32" x2="32" y1="31.75" y2="54.705" gradientUnits="userSpaceOnUse" spreadMethod="reflect"><stop offset="0" stop-color="#6dc7ff"></stop><stop offset="1" stop-color="#e6abff"></stop></linearGradient><path fill="url(#61KRhqZmhJddGRYRcI0Led)" d="M32,54c-6.065,0-11-4.935-11-11s4.935-11,11-11s11,4.935,11,11S38.065,54,32,54z M32,34 c-4.963,0-9,4.037-9,9s4.037,9,9,9s9-4.037,9-9S36.963,34,32,34z"></path></svg>'},84:function(e,t,n){var i=n(85);"string"==typeof i&&(i=[[e.i,i,""]]);var o={insert:"head",singleton:!1};n(21)(i,o);i.locals&&(e.exports=i.locals)},85:function(e,t,n){(e.exports=n(20)(!1)).push([e.i,'.watermark-editor {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n.watermark-editor .surface-container {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  overflow: hidden;\n}\n.watermark-editor .surface-container .surface {\n  position: absolute;\n  display: inline-block;\n  overflow: hidden;\n  transition: top 100ms linear;\n}\n.watermark-editor .surface-container .surface svg {\n  width: 100%;\n  height: 100%;\n}\n.watermark-editor .surface-container .surface svg * {\n  pointer-events: none;\n}\n.watermark-editor .surface-container .surface svg > .image-preview {\n  pointer-events: all;\n}\n.watermark-editor .surface-container .surface .image-preview {\n  transition: opacity 0.1s linear;\n  opacity: 0;\n}\n.watermark-editor .surface-container .surface .image-preview.visible {\n  opacity: 1;\n}\n.watermark-editor .surface-container .surface .selection {\n  fill-opacity: 0;\n  stroke: #1A6DFF;\n  stroke-width: 3px;\n  stroke-dasharray: 5, 5;\n  pointer-events: none;\n}\n.watermark-editor .surface-container .deselect-cover {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n}\n.watermark-editor .item-options {\n  position: absolute;\n  right: auto;\n  bottom: auto;\n  border-radius: 4px;\n  box-shadow: 0 2px 10px 1px rgba(0, 0, 0, 0.2);\n  background-color: #f7f7f7;\n  padding: 7px 14px;\n  overflow: auto;\n  max-height: fit-content;\n}\n.watermark-editor .item-options table {\n  border-spacing: 0 7px;\n  border-collapse: separate;\n}\n.watermark-editor .item-options.with-shadow {\n  border-radius: 4px;\n  box-shadow: 0 2px 10px 1px rgba(0, 0, 0, 0.2);\n}\n.watermark-editor .item-options.hidden {\n  opacity: 0;\n  pointer-events: none;\n}\n.watermark-editor .item-options.empty {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n.watermark-editor .item-options.empty .remove-button {\n  margin-top: 10px;\n  float: right;\n  color: #ff3336;\n}\n.watermark-editor .item-options.empty .remove-button > .trash-bin-icon {\n  font-family: "FontAwesome";\n  font-size: 14px;\n  margin-right: 5px;\n  color: #ff3336;\n}\n.watermark-editor .item-options.test-mode {\n  transition: none;\n}\n.watermark-editor .item-options.animate-top {\n  transition: top linear 200ms;\n}\n.watermark-editor .item-options > * {\n  position: relative;\n}\n.watermark-editor .item-options td:first-child {\n  text-align: right;\n  padding-right: 10px;\n}\n.watermark-editor .item-options td:first-child.name-center {\n  vertical-align: baseline;\n  padding-top: 6px;\n}\n.watermark-editor .item-options td:first-child.effect {\n  vertical-align: baseline;\n}\n.watermark-editor .item-options tr {\n  height: 26px;\n}\n.watermark-editor .item-options tr td > .remove-button {\n  float: left;\n  margin-top: 10px;\n  margin-left: 3px;\n  color: #ff3336;\n}\n.watermark-editor .item-options tr td > .remove-button > .trash-bin-icon {\n  font-family: "FontAwesome";\n  font-size: 14px;\n  margin-right: 5px;\n  color: #ff3336;\n}\n.watermark-editor .item-options tr td > .remove-background {\n  float: left;\n  margin-left: 3px;\n}\n.watermark-editor .item-options tr td > input,\n.watermark-editor .item-options tr td > .short-container,\n.watermark-editor .item-options tr td > .slider,\n.watermark-editor .item-options tr td > .font-picker,\n.watermark-editor .item-options tr td > .shadow-picker,\n.watermark-editor .item-options tr td > .filter-picker,\n.watermark-editor .item-options tr td > .Select,\n.watermark-editor .item-options tr td > textarea,\n.watermark-editor .item-options tr td > .button-group,\n.watermark-editor .item-options tr td > select,\n.watermark-editor .item-options tr td > .virtualized-select {\n  width: 250px;\n}\n.watermark-editor .item-options tr td > textarea {\n  height: 40px;\n  min-height: 40px;\n  max-height: 200px;\n}\n.watermark-editor .item-options tr td > .short-container {\n  display: inline-block;\n  margin-top: 3px;\n}\n.watermark-editor .item-options .item-option-enter {\n  animation-duration: 300ms;\n}\n.watermark-editor .item-options .item-option-enter.item-option-enter-active {\n  animation-name: fadeInDown;\n}\n.watermark-editor .item-options .item-option-leave {\n  animation-duration: 300ms;\n}\n.watermark-editor .item-options .item-option-leave.item-option-leave-active {\n  animation-name: fadeOutUp;\n}\n.watermark-editor .add-symbol {\n  margin-bottom: 5px;\n  margin-top: -2px;\n  display: flex;\n  flex-wrap: wrap;\n}\n.watermark-editor .add-symbol.mobile {\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  width: auto;\n}\n.watermark-editor .add-symbol.mobile button {\n  width: auto;\n}\n.watermark-editor .add-symbol.mobile button:first-child {\n  margin-right: 0;\n  margin-bottom: 5px;\n}\n.watermark-editor .add-symbol button:first-child {\n  margin-right: 5px;\n  display: flex;\n  align-items: center;\n}\n.watermark-editor .add-symbol button:first-child span {\n  font-size: 20px;\n  margin-left: 3px;\n  margin-top: -3px;\n}\n.watermark-editor.mobile .item-options {\n  bottom: 0;\n  left: 0;\n  right: 0;\n  top: 40%;\n  z-index: 2;\n  padding: 7px 14px 7px 7px;\n}\n.watermark-editor.mobile .item-options.only-scale-editor {\n  top: auto;\n  height: auto;\n  max-height: fit-content;\n}\n.watermark-editor.mobile .item-options table {\n  width: 100%;\n}\n.watermark-editor.mobile .item-options table tr td:first-child {\n  text-align: right;\n  padding-right: 10px;\n}\n.watermark-editor.mobile .item-options table tr td:first-child.name-center {\n  vertical-align: baseline;\n  padding-top: 6px;\n}\n.watermark-editor.mobile .item-options table tr td:first-child.effect {\n  vertical-align: baseline;\n}\n.watermark-editor.mobile .item-options table tr td:last-child {\n  width: 75%;\n}\n.watermark-editor.mobile .surface-container .deselect-cover {\n  box-shadow: none;\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n}\n.watermark-editor.mobile:not(.no-pan-to-view) .surface-container .surface {\n  top: 0;\n}\n.watermark-editor.loading .surface-container .surface {\n  transition: none;\n}\n@media (max-width: 420px) {\n  .watermark-editor.mobile .item-options tr td > input,\n  .watermark-editor.mobile .item-options tr td > .short-container,\n  .watermark-editor.mobile .item-options tr td > .slider,\n  .watermark-editor.mobile .item-options tr td > .font-picker,\n  .watermark-editor.mobile .item-options tr td > .shadow-picker,\n  .watermark-editor.mobile .item-options tr td > .filter-picker,\n  .watermark-editor.mobile .item-options tr td > .Select,\n  .watermark-editor.mobile .item-options tr td > textarea,\n  .watermark-editor.mobile .item-options tr td > .button-group,\n  .watermark-editor.mobile .item-options tr td > select,\n  .watermark-editor.mobile .item-options tr td > .virtualized-select {\n    width: 100%;\n  }\n}\n@media (max-width: 375px) {\n  .watermark-editor.mobile .item-options tr {\n    height: 31px;\n  }\n  .watermark-editor.mobile .item-options tr td > input,\n  .watermark-editor.mobile .item-options tr td > .short-container,\n  .watermark-editor.mobile .item-options tr td > .slider,\n  .watermark-editor.mobile .item-options tr td > .font-picker,\n  .watermark-editor.mobile .item-options tr td > .shadow-picker,\n  .watermark-editor.mobile .item-options tr td > .filter-picker,\n  .watermark-editor.mobile .item-options tr td > .Select,\n  .watermark-editor.mobile .item-options tr td > textarea,\n  .watermark-editor.mobile .item-options tr td > .button-group,\n  .watermark-editor.mobile .item-options tr td > select,\n  .watermark-editor.mobile .item-options tr td > .virtualized-select {\n    width: 100%;\n  }\n}\n@media (max-width: 320px) {\n  .watermark-editor.mobile .item-options tr td > input,\n  .watermark-editor.mobile .item-options tr td > .short-container,\n  .watermark-editor.mobile .item-options tr td > .slider,\n  .watermark-editor.mobile .item-options tr td > .font-picker,\n  .watermark-editor.mobile .item-options tr td > .shadow-picker,\n  .watermark-editor.mobile .item-options tr td > .filter-picker,\n  .watermark-editor.mobile .item-options tr td > .Select,\n  .watermark-editor.mobile .item-options tr td > textarea,\n  .watermark-editor.mobile .item-options tr td > .button-group,\n  .watermark-editor.mobile .item-options tr td > select,\n  .watermark-editor.mobile .item-options tr td > .virtualized-select {\n    width: 100%;\n  }\n}\n.visualwatermark .watermark-editor .surface-container .surface .selection {\n  stroke: #ce5b32;\n}\n',""])},86:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 64 64" version="1.1"><defs><linearGradient id="linear0" class="alt-svg-gradient" gradientUnits="userSpaceOnUse" x1="32" y1="11" x2="32" y2="53" spreadMethod="reflect" gradientTransform="matrix(-1,0,0,1,64,0)"><stop offset="0" style="stop-color:rgb(10.196078%,42.745098%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(78.431373%,13.333333%,100%);stop-opacity:1;"></stop></linearGradient><linearGradient id="linear1" class="main-svg-gradient" gradientUnits="userSpaceOnUse" x1="9" y1="16" x2="9" y2="48" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(42.745098%,78.039216%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(90.196078%,67.058824%,100%);stop-opacity:1;"></stop></linearGradient></defs><g id="surface12231"><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear0);" d="M 57 11 L 57 13 L 7 13 L 7 11 Z M 57 31 L 7 31 L 7 33 L 57 33 Z M 43 21 L 7 21 L 7 23 L 43 23 Z M 43 41 L 7 41 L 7 43 L 43 43 Z M 57 51 L 7 51 L 7 53 L 57 53 Z M 57 51 "></path><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear1);" d="M 11 16 L 11 18 L 7 18 L 7 16 Z M 11 26 L 11 28 L 7 28 L 7 26 Z M 11 36 L 11 38 L 7 38 L 7 36 Z M 11 46 L 11 48 L 7 48 L 7 46 Z M 11 46 "></path></g></svg>'},87:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 64 64" version="1.1"><defs><linearGradient id="linear0" class="alt-svg-gradient" gradientUnits="userSpaceOnUse" x1="32" y1="11" x2="32" y2="53" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(10.196078%,42.745098%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(78.431373%,13.333333%,100%);stop-opacity:1;"></stop></linearGradient><linearGradient id="linear1" class="main-svg-gradient" gradientUnits="userSpaceOnUse" x1="32" y1="16" x2="32" y2="48" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(42.745098%,78.039216%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(90.196078%,67.058824%,100%);stop-opacity:1;"></stop></linearGradient></defs><g id="surface381296"><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear0);" d="M 57 11 L 57 13 L 7 13 L 7 11 Z M 7 33 L 57 33 L 57 31 L 7 31 Z M 14 23 L 50 23 L 50 21 L 14 21 Z M 14 43 L 50 43 L 50 41 L 14 41 Z M 7 53 L 57 53 L 57 51 L 7 51 Z M 7 53 "></path><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear1);" d="M 30 16 L 30 18 L 34 18 L 34 16 Z M 34 28 L 34 26 L 30 26 L 30 28 Z M 30 36 L 30 38 L 34 38 L 34 36 Z M 34 48 L 34 46 L 30 46 L 30 48 Z M 34 48 "></path></g></svg>'},88:function(e,t){e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="64px" height="64px" viewBox="0 0 64 64" version="1.1"><defs><linearGradient id="linear0" class="alt-svg-gradient" gradientUnits="userSpaceOnUse" x1="32" y1="11" x2="32" y2="53" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(10.196078%,42.745098%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(78.431373%,13.333333%,100%);stop-opacity:1;"></stop></linearGradient><linearGradient id="linear1" class="main-svg-gradient" gradientUnits="userSpaceOnUse" x1="55" y1="16" x2="55" y2="48" spreadMethod="reflect"><stop offset="0" style="stop-color:rgb(42.745098%,78.039216%,100%);stop-opacity:1;"></stop><stop offset="1" style="stop-color:rgb(90.196078%,67.058824%,100%);stop-opacity:1;"></stop></linearGradient></defs><g id="surface10452"><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear0);" d="M 57 11 L 57 13 L 7 13 L 7 11 Z M 7 33 L 57 33 L 57 31 L 7 31 Z M 21 23 L 57 23 L 57 21 L 21 21 Z M 21 43 L 57 43 L 57 41 L 21 41 Z M 7 53 L 57 53 L 57 51 L 7 51 Z M 7 53 "></path><path style=" stroke:none;fill-rule:nonzero;fill:url(#linear1);" d="M 57 16 L 57 18 L 53 18 L 53 16 Z M 57 26 L 57 28 L 53 28 L 53 26 Z M 57 36 L 57 38 L 53 38 L 53 36 Z M 57 46 L 57 48 L 53 48 L 53 46 Z M 57 46 "></path></g></svg>'}});